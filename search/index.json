[{"content":"import numpy import matplotlib.pyplot import scipy.special %matplotlib inline class neuralNetwork: def __init__(self, inputnodes, hiddennodes, outputnodes, learningrate): # 初始化神经网络 self.inodes = inputnodes self.hnodes = hiddennodes self.onodes = outputnodes self.lr = learningrate # 学习率 # from node i to node j in the next layer self.wih = numpy.random.normal(0.0, pow(self.hnodes, -0.5), (self.hnodes, self.inodes)) # 权重矩阵 self.who = numpy.random.normal(0.0, pow(self.onodes, -0.5), (self.onodes, self.hnodes)) self.activation_function = lambda x: scipy.special.expit(x) # 应用激活函数 def train(self, inputs_list, targets_list): inputs = numpy.array(inputs_list, ndmin=2).T targets = numpy.array(targets_list, ndmin=2).T hidden_inputs = numpy.dot(self.wih, inputs) hidden_outputs = self.activation_function(hidden_inputs) final_inputs = numpy.dot(self.who, hidden_outputs) final_outputs = self.activation_function(final_inputs) output_errors = targets - final_outputs hidden_errors = numpy.dot(self.who.T, output_errors) self.who += self.lr*numpy.dot((output_errors*final_outputs*(1.0-final_outputs)), numpy.transpose(hidden_outputs)) # 调整隐藏层与输出层之间的权重 self.wih += self.lr*numpy.dot((hidden_errors*hidden_outputs*(1.0-hidden_outputs)), numpy.transpose(inputs)) # 调整输入层与隐藏层之间的权重 def query(self, inputs_list): inputs = numpy.array(inputs_list, ndmin=2).T # 输入矩阵的转置矩阵 hidden_inputs = numpy.dot(self.wih, inputs) hidden_outputs = self.activation_function(hidden_inputs) final_inputs = numpy.dot(self.who, hidden_outputs) final_outputs = self.activation_function(final_inputs) return final_outputs input_nodes = 784 # 28*28，输入层节点数 hidden_nodes = 100 # 隐藏层节点数 output_nodes = 10 # 输出层节点 learning_rate = 0.2 # 学习率 # 生成一个神经网络实例 n = neuralNetwork(input_nodes,hidden_nodes,output_nodes,learning_rate) # 加载训练数据 training_data_file = open(\u0026#34;mnist_dataset/mnist_train.csv\u0026#34;, \u0026#39;r\u0026#39;) training_data_list = training_data_file.readlines() training_data_file.close() # 训练神经网络 epochs = 5 # 训练5个世代(本篇的学习率为0.2，训练数据为六万组，训练五个世代，测试数据为一万组) for e in range(epochs): for record in training_data_list: all_values = record.split(\u0026#39;,\u0026#39;) inputs = (numpy.asfarray(all_values[1:])/255.0*0.99)+0.01 targets = numpy.zeros(output_nodes) + 0.01 targets[int(all_values[0])] = 0.99 n.train(inputs,targets) # 加载测试数据(本篇使用了一万组测试数据，正确率为95.11%，结果可能不大一致，但大概都在94%~95%) test_data_file = open(\u0026#34;mnist_dataset/mnist_test.csv\u0026#34;, \u0026#39;r\u0026#39;) test_data_list = test_data_file.readlines() test_data_file.close() # 测试神经网络 scorecard = [] for record in test_data_list: all_values = record.split(\u0026#39;,\u0026#39;) correct_label = int(all_values[0]) # print(correct_label, \u0026#34;correct lable\u0026#34;) inputs = (numpy.asfarray(all_values[1:])/255.0*0.99)+0.01 outputs = n.query(inputs) label = numpy.argmax(outputs) # print(label, \u0026#34;networks\u0026#39;s answer\u0026#34;) if(label == correct_label): scorecard.append(1) else: scorecard.append(0) pass pass # print(scorecard) # 输出训练成绩 scorecard_array = numpy.asarray(scorecard) print(\u0026#34;performances = \u0026#34;, scorecard_array.sum()*1.0/scorecard_array.size) ","date":"2019-10-13T00:00:00Z","image":"https://heaciy.com/p/neural-network-with-python/neural-network_hub24483d86c658fd613211ba0613ee712_190184_120x120_fill_q75_box_smart1.jpeg","permalink":"https://heaciy.com/p/neural-network-with-python/","title":"Neural Network With Python"},{"content":"我爱一切的花朵。\n在任何一个千红万紫的花摊上，各色花朵的壮阔交杂，成了都市中最美的点缀。\n其实并不爱花圃，爱的是旷野上随着季节变化而生长的野花和那微风吹过大地的感动。\n生活在都市里的人，迫不得已在花市中捧些切花回家。对于离开泥土的鲜花，总觉对它们产生一种疼惜又抱歉的心理，可是还是要买的。这种对花的抱歉和喜悦，总也不能过分去分析它。\n我买花，不喜欢小气派。不买也罢了。如果当日要插花，喜欢一口气给它摆成一种气势，大土瓶子哗的一下把房子加添了生命。那种生活情调，可以因为花的进入，完全改观。不然，只水瓶中一朵，也有一份清幽。\n说到清幽，在所有的花朵中，如果是想区别“最爱”，我选择一切白色的花。而白色的花中，最爱野姜花以及百合──长梗的。\n许多年前，我尚在大西洋的小岛上过日子，那时，经济情况拮据，丈夫失业快一年了。我在家中种菜，屋子里插的是一人高的枯枝和芒草，那种东西，艺术品味高，并不差的。我不买花。\n有一日，丈夫和我打开邮箱，又是一封求职被拒的回信。那一阵，其实并没有山穷水尽，粗茶淡饭的日子过得没有悲伤，可是一切维持生命之外的物质享受，已不敢奢求。那是一种恐惧，眼看存款一日一日减少，心里怕得失去了安全感。这种情况只有经历过失业的人才能明白。\n我们眼看求职再一次受挫，没有说什么，去了大菜场，买些最便宜的冷冻排骨和矿泉水，就出来了。\n不知怎么一疏忽，丈夫不见了，我站在大街上等，心事重重的。一会儿，丈夫回来了，手里捧着一小把百合花，兴匆匆的递给我，说：“百合上市了。”\n那一剎间，我突然失了控制，向丈夫大叫起来：“什么时间了？什么经济能力？你有没有分寸，还去买花?!”说着我把那束花啪一下丢到地上去，转身就跑。在举步的那一剎间，其实已经后悔了。我回头，看见丈夫呆了一两秒钟，然后弯下身，把那给撒在地上的花，慢慢拾了起来。\n我往他奔回去，喊着：“荷西，对不起。”我扑上去抱他，他用手围着我的背，紧了一紧，我们对视，发觉丈夫的眼眶红了。\n回到家里，把那孤零零的三五朵百合花放在水瓶里，我好像看见了丈夫的苦心。他何尝不想买上一大缸百合，而口袋里的钱不敢挥霍。毕竟，就算是一小束吧，也是他的爱情。\n那一次，是我的浅浮和急躁，伤害了他。以后我们没有再提这件事。\n四年以后，我去上丈夫的坟，进了花店，我跟卖花的姑娘说：“这五桶满满的花，我全买下，不要担心价钱。”\n坐在满布鲜花的坟上，我盯住那一大片颜色和黄土，眼睛干干的。以后，凡是百合花上市的季节，我总是站在花摊前发呆。\n一个清晨，我去了花市，买下了数百朵百合，把那间房子，摆满了它们。在那清幽的夜晚，我打开全家的窗门，坐在黑暗中，静静的让微风，吹动那百合的气息。\n那是丈夫逝去了七年之后。又是百合花的季节了，看见它们，立即看见当年丈夫弯腰去地上拾花的景象。没有泪，而我的胃，开始抽痛起来。\n 作者: 三毛 (选自《思念的长河》)\n ","date":"2019-09-19T00:00:00Z","image":"https://heaciy.com/p/%E5%A4%9C%E6%B7%B1%E8%8A%B1%E7%9D%A1/the-creative-exchange-d2zvqp3fpro-unsplash_huf941de4769045cdfa8c9ee7036519a2a_35369_120x120_fill_q75_box_smart1.jpg","permalink":"https://heaciy.com/p/%E5%A4%9C%E6%B7%B1%E8%8A%B1%E7%9D%A1/","title":"夜深花睡"}]