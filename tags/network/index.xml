<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Network on Heaciy&#39;s Blog</title>
        <link>https://heaciy.com/tags/network/</link>
        <description>Recent content in Network on Heaciy&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>Heaciy&#39;s Blog</copyright>
        <lastBuildDate>Thu, 19 Jun 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://heaciy.com/tags/network/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>zxcvbn åŸç†è¯¦è§£</title>
        <link>https://heaciy.com/p/zxcvbn-explained/</link>
        <pubDate>Thu, 19 Jun 2025 00:00:00 +0000</pubDate>
        
        <guid>https://heaciy.com/p/zxcvbn-explained/</guid>
        <description>&lt;img src="https://heaciy.com/p/zxcvbn-explained/artiom-vallat-y7nZ4ENg7ic-unsplash.jpg" alt="Featured image of post zxcvbn åŸç†è¯¦è§£" /&gt;&lt;blockquote&gt;
&lt;p&gt;å‰è¨€ï¼š
å› ä¸ºå·¥ä½œä¸­çš„ä¸€ä¸ªè®¡ç®—å¯†ç å¼ºåº¦çš„éœ€æ±‚ï¼Œäº†è§£åˆ° zxcvbn è¿™ä¸ªåº“ï¼ŒèŠ±äº†æ®µæ—¶é—´çœ‹äº†çœ‹å®ƒçš„ java å®ç°å’Œç›¸å…³è®ºæ–‡ï¼Œç¼–å†™æ­¤æ–‡ä½œä¸ºç¬”è®°å­˜æ¡£ã€‚æ³¨æ„ï¼šæœ¬æ–‡ä¾§é‡å…¶ç®—æ³•å®ç°å’Œå¤æ‚åº¦è®¡ç®—ï¼Œä¸æ¶‰åŠå…¶ä½¿ç”¨æ–¹æ³•ä»¥åŠä¸å…¶ä»–åº“çš„å¯¹æ¯”ã€‚æœ¬æ–‡ä¸­çš„å…¬å¼å‡æ‘˜è‡ª Dropbox ç›¸å…³åšå®¢å’Œè®ºæ–‡ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;æ¦‚è¿°&#34;&gt;æ¦‚è¿°
&lt;/h2&gt;&lt;p&gt;zxcvbn æ˜¯ä¸€ä¸ªç”± Dropbox å¼€å‘çš„å¯†ç å¼ºåº¦ä¼°ç®—åº“ï¼Œçµæ„Ÿæ¥è‡ªäºå¯†ç çˆ†ç ´å·¥å…·ï¼Œå…¶å…¨ç§°æ˜¯ &amp;ldquo;zxcvbn: realistic password strength estimation&amp;rdquo;ï¼Œæ—¨åœ¨æä¾›ä¸€ç§æ›´å‡†ç¡®ã€ç”¨æˆ·å‹å¥½çš„å¯†ç å¼ºåº¦è¯„ä¼°æ–¹æ³•ã€‚zxcvbn çš„å¼ºåº¦ä¼°è®¡æ˜¯åŸºäºä¸€ä¸ªæƒ³æ³•ï¼š&lt;/p&gt;
&lt;p&gt;çŒœæµ‹å¯†ç éš¾åº¦ â‰ˆ ç ´è§£è€…ä½¿ç”¨æœ€ä¼˜ç­–ç•¥æ‰€éœ€å°è¯•çš„æ¬¡æ•°ï¼ˆguessesï¼‰&lt;/p&gt;
&lt;p&gt;æ¢å¥è¯è¯´ï¼Œzxcvbn è¯•å›¾æ¨¡æ‹Ÿä¸€ä¸ªæœ€èªæ˜çš„é»‘å®¢ï¼ˆåˆ©ç”¨æ‰€æœ‰å·²çŸ¥æŠ€æœ¯å’Œè¯åº“ï¼‰å¦‚ä½•æœ€æœ‰æ•ˆåœ°ç ´è§£è¿™ä¸ªå¯†ç ã€‚ç„¶åæ ¹æ®æ‰€éœ€çš„å°è¯•æ¬¡æ•°æ¥ä¼°ç®—ç ´è§£æ—¶é—´å’Œç»™å‡ºæ‰“åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;zxcvbn å°†å¯†ç ç ´è§£éš¾åº¦çš„è®¡ç®—å¤§è‡´åˆ†ä¸ºäº†ä¸‰æ­¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŒ¹é…ï¼šæ¨¡å¼åŒ¹é…ï¼Œzxcvbn ä¼šå°è¯•å¯¹è¾“å…¥å¯†ç è¿›è¡Œå­ä¸²åˆ’åˆ†ï¼Œå®ƒå°è¯•ä»¥å¤šç§æ–¹å¼å°†å¯†ç æ‹†æˆå­ä¸²ï¼Œæ¯ä¸ªå­ä¸²å¯¹åº”ä¸€ç§æ¨¡å¼(match)ï¼Œå³è¯¥å­ä¸²ç¬¦åˆä»€ä¹ˆç‰¹å¾ï¼Œå¦‚è‹¥å¯†ç å­—å…¸(åŒ…å«å¸¸ç”¨å•è¯ã€å§“å)ã€é”®ç›˜è·¯å¾„ï¼Œå…·ä½“æœ‰å“ªå‡ ç§æ¨¡å¼å°†åœ¨ä¸‹æ–‡å…·ä½“ä»‹ç»ã€‚&lt;/li&gt;
&lt;li&gt;è¯„ä¼°ï¼šç ´è§£æ‰€éœ€çš„å°è¯•æ¬¡æ•°ï¼Œå¯¹äºæ¯ä¸ªè¯†åˆ«å‡ºçš„æ¨¡å¼å­ä¸²ï¼Œzxcvbn ä¼šè®¡ç®—å…¶å¯èƒ½çš„å°è¯•æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;æœç´¢ï¼šä½¿ç”¨ &lt;strong&gt;åŠ¨æ€è§„åˆ’&lt;/strong&gt; ç®—æ³•ï¼Œzxcvbn è¯•å›¾æ‰¾å‡ºä¸€ç»„é¦–å°¾ç›¸æ¥å­ä¸²ç»„åˆï¼Œä½¿å¾—æ€»çŒœæµ‹æ•°æœ€å°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ¨¡å¼åŒ¹é…&#34;&gt;æ¨¡å¼åŒ¹é…
&lt;/h2&gt;&lt;h3 id=&#34;zxcvbn-åŒ…å«çš„åŒ¹é…æ¨¡å¼&#34;&gt;zxcvbn åŒ…å«çš„åŒ¹é…æ¨¡å¼
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—å…¸åŒ¹é…&lt;/strong&gt;ï¼šç»´æŠ¤ä¸€ä¸ªå¸¦æ’åçš„å¼±å¯†ç å­—å…¸ï¼Œå¦‚ï¼šadminã€admin123ã€logitech&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åå‘å­—å…¸åŒ¹é…&lt;/strong&gt;ï¼šåŸºäºå­—å…¸åŒ¹é…ï¼Œå¼±å¯†ç å­—å…¸ä¸­çš„è¯æ±‡å€’åºï¼Œå¦‚ï¼šdrowssapï¼Œnimda&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;leet åŒ¹é…&lt;/strong&gt;ï¼šåŸºäºå­—å…¸åŒ¹é…ï¼Œå°†ä¸€äº›å­—ç¬¦åšç›¸ä¼¼æ›¿æ¢ï¼Œå¦‚ï¼šp@ssw0rd&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”®ä½åŒ¹é…&lt;/strong&gt;ï¼šé”®ç›˜ä¸Šçš„è¿ç»­å­—ç¬¦ï¼Œå¦‚ï¼šqwertyã€qazwx&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡å¤åŒ¹é…&lt;/strong&gt;ï¼šé‡å¤çš„å­—ç¬¦æˆ–è€…åºåˆ—ï¼Œå¦‚ï¼šzzzã€ababab&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºåŒ¹é…&lt;/strong&gt;ï¼šæœ‰é¡ºåºçš„è¿ç»­å­—ç¬¦ï¼Œå¦‚ï¼šabcã€123ã€246&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥æœŸåŒ¹é…&lt;/strong&gt;ï¼šæ—¥æœŸå­—ç¬¦ä¸²ï¼Œå¦‚ï¼š20000102ã€7/8/1947&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æš´åŠ›ç ´è§£åŒ¹é…&lt;/strong&gt;ï¼šæ— æ³•ä½¿ç”¨ä¸Šè¿°æ–¹æ³•åŒ¹é…çš„åºåˆ—ï¼Œå¦‚ï¼šx$JQhMzt&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­£åˆ™åŒ¹é…&lt;/strong&gt;ï¼šå®é™…ä»£ç ä¸­æ¯”è®ºæ–‡ä¸­è¿˜å¤šäº†ä¸€ç§æ­£åˆ™åŒ¹é…ï¼Œå†…ç½®å¸¸è§çš„æ•°æ®æ ¼å¼æ­£åˆ™æ¯”å¦‚æœ€è¿‘çš„å¹´ä»½&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ¨¡å¼åŒ¹é…çš„å®ç°åŸç†&#34;&gt;æ¨¡å¼åŒ¹é…çš„å®ç°åŸç†
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—å…¸åŒ¹é…ã€åå‘å­—å…¸åŒ¹é…ã€leet åŒ¹é…&lt;/strong&gt; ï¼šé¦–å…ˆå°†æ•´ä¸ªå¯†ç å­—ç¬¦ä¸²å°å†™ï¼Œç„¶åå†è·å–è¯¥å°å†™å¯†ç çš„æ‰€æœ‰å­ä¸²ï¼Œéå†å­ä¸²çœ‹å…¶æ˜¯å¦åœ¨å¯†ç æ’åå­—å…¸ä¸­ï¼›åå‘å­—å…¸åŒ¹é…åœ¨æ­¤åŸºç¡€ä¸Šå°†å­ä¸²åè½¬åˆ¤æ–­å…¶æ˜¯å¦åœ¨æ’åå­—å…¸ä¸­ï¼›leet åŒ¹é…åˆ™ä¼šæ ¹æ®æ›¿æ¢è§„åˆ™ï¼Œå¾—åˆ°ä¸€ä¸ªå­ä¸²çš„æ‰€æœ‰ leet æ›¿æ¢å€¼ï¼Œå†åˆ¤æ–­æ›¿æ¢åçš„å­ä¸²æ˜¯å¦åœ¨æ’åå­—å…¸ä¸­ï¼Œå¦‚&lt;code&gt;@ba1one&lt;/code&gt;ï¼Œl33t è¡¨ä¼šå°†&lt;code&gt;@&lt;/code&gt;æ˜ å°„åˆ°&lt;code&gt;a&lt;/code&gt;ï¼Œå°†&lt;code&gt;1&lt;/code&gt;æ˜ å°„åˆ°&lt;code&gt;i&lt;/code&gt;æˆ–è€…&lt;code&gt;l&lt;/code&gt;(å³æŒ‰ç…§ leet è§„åˆ™å°†å­—ç¬¦ä¸²ä¸­çš„ç¬¦å·å’Œæ•°å­—æ›¿æ¢ä¸ºå¯¹åº”çš„å­—æ¯)ï¼Œå› æ­¤å®ƒä¼šé€šè¿‡æ›¿æ¢ &lt;code&gt;[@-&amp;gt;a, 1-&amp;gt;i]&lt;/code&gt; å’Œ &lt;code&gt;[@-&amp;gt;a, 1-&amp;gt;l]&lt;/code&gt;åˆ†ä¸¤æ¬¡å°è¯•å»æ’åå­—å…¸ä¸­åŒ¹é…ï¼Œç¬¬äºŒæ¬¡ä¼šåŒ¹é…ä¸­å•è¯&lt;code&gt;abalone&lt;/code&gt;(å•è¯ï¼šé²é±¼)ï¼›
zxcvbn çš„å¯†ç å­—å…¸åŒ…æ‹¬ï¼šè‹±è¯­è¯æ±‡è¡¨ã€å¸¸ç”¨äººåã€å¸¸ç”¨å¯†ç ã€å¸¸ç”¨å§“æ°ã€ç¾å›½ç”µå½±å’Œç”µè§†å‰§å&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºåŒ¹é…&lt;/strong&gt;ï¼šé€šè¿‡è®¡ç®—ç›¸é‚»å­—ç¬¦çš„ unicode ç çš„å·®å€¼æ¥æ‰¾åˆ°é¡ºåºï¼Œä¸€ä¸ªâ€é€’å¢â€œæˆ–â€é€’å‡â€œçš„å­ä¸²å…¶ç›¸é‚»å­—ç¬¦çš„ unicode ç çš„å·®å€¼æ˜¯ç›¸åŒçš„ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡å¤åŒ¹é…&lt;/strong&gt;ï¼šé€šè¿‡ä½¿ç”¨è´ªå©ªæ­£åˆ™&lt;code&gt;&amp;quot;(.+)\1+&amp;quot;&lt;/code&gt;å’Œæ‡’æƒ°æ­£åˆ™&lt;code&gt;&amp;quot;(.+?)\1+&amp;quot;&lt;/code&gt;æ¥è¯†åˆ«å¯†ç å­—ç¬¦ä¸²ä¸­çš„é‡å¤å—ã€‚å¯¹äºå­—ç¬¦ä¸² &amp;ldquo;aabaab&amp;rdquo; è´ªå©ªæ¨¡å¼çš„ç»“æœ(aab)è¾ƒæ‡’æƒ°æ¨¡å¼çš„ç»“æœ(aa)ä¼šèƒœå‡ºï¼Œå› ä¸ºè´ªå©ªæ¨¡å¼è¦†ç›–çš„é•¿åº¦ä¸º 6(&amp;ldquo;aabaab&amp;rdquo;)è€Œè´ªå©ªæ¨¡å¼è¦†ç›–çš„é•¿åº¦ä¸º 2(&amp;ldquo;aa&amp;rdquo;)ï¼›å¯¹äº &amp;ldquo;aaaaa&amp;rdquo; æ‡’æƒ°æ¨¡å¼è¦†ç›–é•¿åº¦ä¸º 5(&amp;ldquo;aaaaa&amp;rdquo;)ï¼Œè€Œè´ªå©ªæ¨¡å¼è¦†ç›–é•¿åº¦ä¸º 4(&amp;ldquo;aaaa&amp;rdquo;)ï¼Œæ•…æ‡’æƒ°æ¨¡å¼èƒœå‡ºã€‚åœ¨å¾—åˆ°æ•´ä¸ªå¯†ç çš„æ‰€æœ‰é‡å¤å•å…ƒåï¼Œä¼šå†å¯¹æ¯ä¸ªé‡å¤å•å…ƒå†æ‰§è¡Œå®Œæ•´çš„åŒ¹é…è¿‡ç¨‹(å³å¯¹å­ä¸²å†æ‰§è¡Œä¸€éæœç´¢çš„æ¨¡å¼åŒ¹é…)ï¼Œä»¥æ­¤è¯†åˆ«é‡å¤çš„å•è¯æˆ–æ—¥æœŸï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”®ä½åŒ¹é…&lt;/strong&gt;ï¼šéå†å¯†ç å­—ç¬¦ä¸²ï¼Œå¯¹æ¯”å¤šç§é”®ç›˜é”®ä½çš„é‚»æ¥å›¾ï¼Œæ‰¾åˆ°å¯†ç ä¸­é”®ä½ç›¸é‚»çš„æ¨¡å¼å­ä¸²ï¼Œå¹¶è®°å½•æ¯ä¸ªæ¨¡å¼å­ä¸²çš„é•¿åº¦ã€è½¬æŠ˜æ¬¡æ•°ã€shift é”®(å¦‚!@#$%QAZ)çš„æ•°é‡ä»¥åŠé”®ç›˜ç§ç±»ã€‚å¦‚å¯†ç â€œzxcvfR$321â€å°†ä¼šè¢«è®°å½•ä¸ºä»¥ä¸‹æ•°æ®ï¼šé”®ç›˜ç§ç±»-qwertyã€è½¬æŠ˜æ¬¡æ•°-3ã€shifté”®æ•°é‡-2(Rå’Œ$)ã€é•¿åº¦-10ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¥æœŸåŒ¹é…&lt;/strong&gt;ï¼šå¯¹äºä¸å¸¦åˆ†éš”ç¬¦( &lt;code&gt;/ \ _ . - ç©ºæ ¼&lt;/code&gt;)çš„æ—¥æœŸæ ¼å¼ï¼Œéå†æ•´ä¸ªå¯†ç å­—ç¬¦ä¸²ï¼ŒåŒ¹é…é•¿åº¦ä¸º 4~8 çš„æ•°å­—å­ä¸²å¦‚&lt;code&gt;&#39;1191&#39;&lt;/code&gt;&lt;em&gt;ã€&lt;/em&gt;&lt;code&gt;&#39;11111991&#39;&lt;/code&gt;ï¼Œç„¶åé’ˆå¯¹ä¸åŒé•¿åº¦ä½¿ç”¨ä¸åŒçš„åˆ†å‰²ç­–ç•¥åˆ†å‰²ä¸ºä¸‰éƒ¨åˆ†ç»„åˆã€è¿‡æ»¤å‡ºæ—¥æœŸï¼Œå†ä»è¿™äº›æ—¥æœŸä¸­æŒ‘å‡ºç¦»ç°åœ¨æœ€è¿‘çš„æ—¥æœŸä½œä¸ºæœ€ä¼˜è§£ï¼›å¯¹äºå¸¦åˆ†éš”ç¬¦çš„æ—¥æœŸæ ¼å¼ï¼Œéå†æ•´ä¸ªå¯†ç å­—ç¬¦ä¸²ï¼ŒåŒ¹é…é•¿åº¦ä¸º 6~10 çš„æ•°å­—å­ä¸²å¦‚&lt;code&gt;&#39;1/1/91&#39;&lt;/code&gt;ã€&lt;code&gt;&#39;11/11/1991&#39;&lt;/code&gt;ï¼Œä½¿ç”¨æ­£åˆ™åŒ¹é…åˆ†å‰²ä¸ºä¸‰éƒ¨åˆ†ï¼Œç„¶åé‡å¤ä¸Šè¿°çš„é€»è¾‘ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ­£åˆ™åŒ¹é…&lt;/strong&gt;ï¼š&lt;a class=&#34;link&#34; href=&#34;https://github.com/dropbox/zxcvbn/blob/67c4ece9efc40c9d0a1d7d995b2b22a91be500c2/src/matching.coffee#L37&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å®é™…ä»£ç å®ç°ä¸­&lt;/a&gt;åªå†…ç½®äº†ä¸€ç§å¸¸ç”¨æ­£åˆ™å³æœ€è¿‘å¹´ä»½ç”¨äºåŒ¹é… 19** æˆ–è€… 20** è¿™ç§å¹´ä»½ï¼Œå¦‚ 1999ã€2019ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è¯„ä¼°å°è¯•æ¬¡æ•°&#34;&gt;è¯„ä¼°å°è¯•æ¬¡æ•°
&lt;/h2&gt;&lt;h3 id=&#34;æ¯ç§æ¨¡å¼çš„çŒœæµ‹æ¬¡æ•°è®¡ç®—&#34;&gt;æ¯ç§æ¨¡å¼çš„çŒœæµ‹æ¬¡æ•°è®¡ç®—
&lt;/h3&gt;&lt;p&gt;å¯¹äºæ¨¡å¼åŒ¹é…é˜¶æ®µçš„ç»“æœï¼Œåœ¨è¯„ä¼°é˜¶æ®µä¼šè®¡ç®—å…¶ä¸­æ¯ä¸€ä¸ªæ¨¡å¼å­ä¸²çš„çŒœæµ‹æ¬¡æ•°ï¼Œå¯¹æ¯ç§æ¨¡å¼çš„å­ä¸²çš„çŒœæµ‹è®¡ç®—æ–¹æ³•æ ¹æ®æ¨¡å¼åŒ¹é…ç‰¹ç‚¹å†³å®šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å­—å…¸å’Œåå‘å­—å…¸åŒ¹é…&lt;/strong&gt;ï¼šå‡è®¾æ”»å‡»è€…æŒ‰ç…§å¼±å¯†ç æµè¡Œåº¦é¡ºåºçŒœæµ‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºå­—å…¸åŒ¹é…ï¼Œæ¨¡å¼å­ä¸²çš„çŒœæµ‹æ¬¡æ•°å³ä¸ºå¼±å¯†ç å­—å…¸æ’åå€¼ï¼›&lt;/li&gt;
&lt;li&gt;å¯¹äºåå‘å­—å…¸åŒ¹é…ï¼Œç”±äºéœ€è¦å°è¯•å­—å…¸å€¼çš„æ­£åä¸¤ç§æƒ…å†µï¼Œå› æ­¤è¿˜è¦åœ¨æµè¡Œåº¦æ’åå€¼çš„åŸºç¡€ä¸Šä¹˜äºŒï¼›&lt;/li&gt;
&lt;li&gt;å¯¹äºä»…é¦–å­—æ¯ã€ä»…å°¾å­—æ¯å’Œå…¨éƒ¨å­—æ¯ä¸ºå¤§å†™çš„ä¸‰ç§æƒ…å†µï¼Œä¹Ÿéœ€è¦åœ¨æµè¡Œåº¦æ’åå€¼å¾—åŸºç¡€ä¸Šä¹˜äºŒï¼›&lt;/li&gt;
&lt;li&gt;å¯¹äºå…¶ä»–çš„å¤§å°å†™æƒ…å†µ(å¦‚ï¼šå¯¹äºå¯†ç &lt;code&gt;paSswOrd&lt;/code&gt;ï¼Œéœ€è¦åœ¨çŒœå‡º&lt;code&gt;password&lt;/code&gt;çš„åŸºç¡€ä¸Šï¼Œå†çŒœå‡ºå“ªäº›ä½ç½®çš„å­—æ¯æ˜¯å¤§å†™)ä½¿ç”¨ä¸‹é¢çš„å…¬å¼è®¡ç®—ï¼š&lt;/li&gt;
&lt;/ul&gt;
$$
   \frac{1}{2}\sum_{i=1}^{\min(U,L)}\binom{U+L}{i}
   $$&lt;p&gt;å…¬å¼è§£è¯»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$U$ï¼šå¤§å†™å­—æ¯æ•°é‡&lt;/li&gt;
&lt;li&gt;$L$ï¼šå°å†™å­—æ¯æ•°é‡&lt;/li&gt;
&lt;li&gt;$\min(U,L)$ï¼šå–ä¸¤å€¼ä¸­çš„è¾ƒå°å€¼ï¼Œå½“å¤§å†™å­—æ¯æ•°é‡å¤§äºå°å†™å­—æ¯æ•°é‡æ—¶ï¼Œæ”¹ä¸ºçŒœæµ‹å°å†™å­—æ¯&lt;/li&gt;
&lt;li&gt;$\binom{U+L}{i}$ï¼šç»„åˆå…¬å¼ $C^{i}_{U+L}$ ï¼Œå³ä» $U+L$ ä¸ªä¸­é€‰å‡º $i$ ä¸ªæœ‰å¤šå°‘ç§é€‰æ³•&lt;/li&gt;
&lt;li&gt;$\frac{1}{2}\sum_{i=1}^{\min(U,L)}\binom{U+L}{i}$ï¼šæ”»å‡»è€…ä¸çŸ¥é“å…¶ä¸­æœ‰å¤šå°‘ä¸ªå¤§å†™å­—æ¯ï¼Œå‡è®¾æ”»å‡»è€…ä» 1 ä¸ªå¤§å†™å­—æ¯å°è¯•åˆ° $min(U,L)$ï¼Œå½“å°è¯•åˆ°å¤§å†™å­—æ¯æ•°é‡ä¸º $i$ æ—¶ï¼Œæ­¤è½®å…±éœ€è¦å°è¯• $C^i_{U+L}$ æ¬¡ï¼Œè®°ä¸º $\binom{U+L}{i}$ï¼Œ$i$ éœ€è¦ä» 1 å°è¯•åˆ° $min(U,L)$ï¼Œæ€»æ•°ä¸º $\binom{U+L}{i}+\binom{U+L}{i}+&amp;hellip;+\binom{U+L}{min(U,L)}$ è®°ä¸º $\sum_{i=1}^{\min(U,L)}\binom{U+L}{i}$ï¼Œæœ€åæ·»åŠ ä¸€ä¸ª $\frac{1}{2}$ æ¥å–å¹³å‡çŒœæµ‹æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Leet åŒ¹é…&lt;/strong&gt;ï¼šåœ¨å­—å…¸åŒ¹é…çš„åŸºç¡€ä¸Šï¼Œä¸ä¸Šè¿°å¤§å°å†™æ›¿æ¢çš„è®¡ç®—æ–¹å¼ä¸€è‡´ï¼Œåªä¸è¿‡æ˜¯å°†å¤§å†™å­—ç¬¦æ›¿æ¢æ”¹ä¸ºäº† leet å­—ç¬¦æ›¿æ¢ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é”®ä½åŒ¹é…&lt;/strong&gt;ï¼šå¯¹äºé”®ä½åŒ¹é…ï¼Œå‡è®¾æ”»å‡»è€…æ€»æ˜¯ä»è¾ƒçŸ­çš„é”®ä½åŒ¹é…é•¿åº¦(æœ€çŸ­ä¸º 2)å’Œè¾ƒå°‘çš„æ–¹å‘(æœ€å°‘ä¸º 1)å¼€å§‹è®¡ç®—ã€‚ä»¥ &lt;code&gt;qwertyhnm&lt;/code&gt; ä¸ºä¾‹ï¼Œå®ƒä» &lt;code&gt;q&lt;/code&gt; å¼€å§‹ï¼Œé•¿åº¦ä¸º 9ï¼ŒåŒ…å« 3 ä¸ªæ–¹å‘ï¼šæœ€å¼€å§‹å‘å³(&lt;code&gt;qwerty&lt;/code&gt;)ï¼Œç„¶åå‘å³ä¸‹(&lt;code&gt;yhn&lt;/code&gt;)ï¼Œç„¶åå‘å³(&lt;code&gt;nm&lt;/code&gt;)ã€‚&lt;/p&gt;
$$
   \frac{1}{2}\sum_{i=2}^{L}\sum_{j=1}^{\min(T,i-1)}\binom{i-1}{j-1}SD^j
   $$&lt;p&gt;å…¬å¼è§£è¯»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$L$ï¼šå¯†ç çš„é•¿åº¦&lt;/li&gt;
&lt;li&gt;$T$ï¼šå¯†ç åœ¨é”®ç›˜ä¸Šæ–¹å‘æ®µæ•°&lt;/li&gt;
&lt;li&gt;$D$ï¼šé”®ç›˜ä¸Šæ¯ä¸ªé”®å¹³å‡çš„ç›¸é‚»é”®æ•°&lt;/li&gt;
&lt;li&gt;$S$ï¼šé”®ç›˜ä¸Šé”®çš„ä¸ªæ•°&lt;/li&gt;
&lt;li&gt;$i$ï¼šå‡è®¾é”®ä½åŒ¹é…æ¨¡å¼å­ä¸²çš„é•¿åº¦ä¸º $i$ï¼Œä» 2 å¼€å§‹ï¼ˆ1 é•¿åº¦æ²¡æœ‰â€œè½¬å‘â€çš„æ„ä¹‰ï¼‰&lt;/li&gt;
&lt;li&gt;$j$ï¼šå‡è®¾é•¿åº¦ä¸º $i$ çš„é”®ä½åŒ¹é…æ¨¡å¼å­ä¸²åŒ…å« $j$ ä¸ªæ–¹å‘æ®µï¼Œå³å¯¹åº” $j-1$ æ¬¡è½¬å‘ï¼Œä¸èƒ½è¶…è¿‡ $i-1$ æˆ–æœ€å¤§æ–¹å‘æ®µæ•° $T$&lt;/li&gt;
&lt;li&gt;$SD^j$ï¼šé”®ç›˜ä¸Šä»»æ„ä¸€ä¸ªå­—ç¬¦éƒ½æœ‰å¯èƒ½ä½œä¸ºèµ·å§‹å­—ç¬¦ï¼Œæ¯ä¸€ä¸ªæ–¹å‘æ®µéƒ½æœ‰ $D$ ç§æ–¹å‘é€‰æ‹©ï¼Œå…± $j$ æ®µã€‚(&lt;em&gt;è¿™é‡Œåº”è¯¥ä¹Ÿæ˜¯ä¼°ç®—ï¼Œå› ä¸ºç¬¬äºŒä¸ªæ–¹å‘æ®µçš„æ–¹å‘è‚¯å®šä¸ç¬¬ä¸€ä¸ªæ–¹å‘æ®µæ–¹å‘ä¸åŒï¼Œé‚£èƒ½é€‰çš„æ–¹å‘åº”è¯¥æ˜¯ $D-1$ï¼Œå¯¹åº” $S \cdot D \cdot D^{j-1}$ï¼Œä¸è¿‡è¿™é‡Œçš„æ•°é‡çº§åº”è¯¥æ˜¯ä¸€æ ·çš„ä¸” $D$ æœ¬èº«ä¸æ˜¯ç²¾ç¡®å€¼ï¼Œæ‰€ä»¥ç›´æ¥ç®€åŒ–ä¸º $SD^j$ ä¹Ÿæ— å¦¨&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;$\binom{i-1}{j-1}$ï¼šåœ¨ $i$ ä¸ªé”®ä¸ŠåŒ…å« $j$ ä¸ªæ–¹å‘æ®µï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š$j$ ä¸ªæ–¹å‘æ®µå¯¹åº” $j-1$ æ¬¡è½¬å‘ï¼Œè½¬å‘åº”è¯¥å‘ç”Ÿåœ¨â€œå†…éƒ¨é”®â€ä¸Šï¼Œè€Œ $i$ ä¸ªé”®ä½å¯¹åº” $i-2$ ä¸ªå†…éƒ¨é”®(å³å»é™¤é¦–å°¾é”®)ï¼Œé‚£ä½è¯¥é—®é¢˜è½¬åŒ–ä¸ºåœ¨ $i-2$ ä¸ªå†…éƒ¨é”®ä¸­æŒ‘é€‰å‡º $j-1$ ä¸ªä½œä¸ºè½¬å‘é”®ï¼Œå¯¹åº”çš„ç»„åˆå…¬å¼å³ä¸º $\binom{i-2}{j-1}$ã€‚&lt;strong&gt;â‰ï¸ ç¦»è°±çš„æ¥çš„ï¼Œæ€ä¹ˆè·Ÿè®ºæ–‡é‡Œçš„å…¬å¼å¯¹ä¸ä¸Š ğŸ˜…&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;$\frac{1}{2}\sum_{i=2}^{L}\sum_{j=1}^{\min(T,i-1)}\binom{i-1}{j-1}SD^j$ï¼šå‡è®¾æ”»å‡»è€…æ€»æ˜¯ä»è¾ƒçŸ­çš„åºåˆ—é•¿åº¦(æœ€çŸ­ä¸º 2)å’Œè¾ƒå°‘çš„æ–¹å‘æ®µæ•°(æœ€å°‘ä¸º 1)å¼€å§‹çŒœæµ‹ï¼Œé’ˆå¯¹ $i$ ä» $2$ åˆ° $L$ çš„æ¯ç§åºåˆ—é•¿åº¦çš„æƒ…å†µï¼Œæ–¹å‘æ®µæ•°ä» 1 æœ€å¤šå°è¯•åˆ° $min(T,i-1)$ æ¬¡ï¼›æ¯ç§é•¿åº¦çš„æ¨¡å¼å­ä¸²çš„é¦–å­—ç¬¦æœ‰ $S$ ç§é€‰æ‹©ï¼Œæ¯ä¸ªæ–¹å‘æ®µæœ‰ $D$ ç§æ–¹å‘é€‰æ‹©ï¼Œå…±æœ‰ $j$ ä¸ªæ–¹å‘æ®µï¼Œæ•…é’ˆå¯¹æ¯ç§ç©ºé—´æ¨¡å¼çš„æ¨¡å¼å­ä¸²éƒ½æœ‰ $SD^j$ ç§å¯èƒ½ï¼›$\frac{1}{2}$ ç”¨äºè®¡ç®—å¹³å‡æƒ…å†µï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;âš ï¸ æ³¨æ„ âš ï¸ï¼šä¸Šè¿°ä¸ªäººç†è§£ä¸è®ºæ–‡ä¸­çš„å…¬å¼å¯¹ä¸ä¸Š ğŸ˜…ï¼Œä¸å¿…æƒŠæ…Œæ•°é‡çº§åº”è¯¥æ˜¯ä¸€æ ·çš„é‚£å°±å…ˆå‡‘åˆç”¨è®ºæ–‡ä¸­çš„å…¬å¼å§ï¼Œå½“ç„¶æˆ‘çš„ç†è§£å¯èƒ½ä¹Ÿæ˜¯é”™çš„æ¬¢è¿æŒ‡æ­£ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…¶å®ä¸‹é¢&lt;a class=&#34;link&#34; href=&#34;https://www.usenix.org/system/files/conference/usenixsecurity16/sec16_paper_wheeler.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å‚è€ƒé“¾æ¥é‡Œçš„è®ºæ–‡&lt;/a&gt;ä¸­å­˜åœ¨å¤šå¤„å…¬å¼ä¸ä»£ç å®ç°ä¸ç¬¦ä¸”å­˜åœ¨é”™è¯¯â€¦â€¦ç»è¿‡æŸ¥çœ‹ &lt;a class=&#34;link&#34; href=&#34;https://github.com/dropbox/zxcvbn/blob/67c4ece9efc40c9d0a1d7d995b2b22a91be500c2/src/scoring.coffee#L288&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Dropbox å®˜æ–¹çš„ä»£ç åº“å®ç°&lt;/a&gt;å’Œç›¸å…³çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/nulab/zxcvbn4j/blob/c08b8b8455623023ef040406afc0fb988b4e3c12/src/main/java/com/nulabinc/zxcvbn/guesses/SpatialGuess.java#L25&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;java åº“å®ç°&lt;/a&gt;åå‘ç°ï¼Œå®é™…å¹¶æ²¡æœ‰ä½¿ç”¨è®ºæ–‡ä¸­æåˆ°çš„ $\frac{1}{2}$ æ¥è®¡ç®—å¹³å‡å°è¯•æƒ…å†µï¼Œé™¤äº†é”®ä½åŒ¹é…ï¼Œå­—å…¸åŒ¹é…çš„å®ç°ä¸­ä¹Ÿæ²¡æœ‰ä½¿ç”¨ $\frac{1}{2}$ æ¥è®¡ç®—å¹³å‡å€¼ã€‚ä»£ç å®ç°ä¸­å®é™…ä½¿ç”¨çš„å…¬å¼å¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
$$
   \sum_{i=2}^{L}\sum_{j=1}^{\min(T,i-1)}\binom{i-1}{j-1}\cdot S \cdot D^j \cdot \text{shift\_factor}
   $$&lt;p&gt;å…¬å¼è§£è¯»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$\text{shift\_factor}$ï¼šå¤§å†™å› å­ï¼Œå³æŒ‰ä½ shift é”®è¾“å…¥çš„å€¼ï¼Œæ¯”å¦‚å¤§å†™çš„å­—æ¯æˆ–æ˜¯æ•°å­—é”®å¯¹åº”çš„ç¬¦å·å¦‚ !@# ç­‰ã€‚
&lt;ul&gt;
&lt;li&gt;å½“æ•´ä¸ªæ¨¡å¼å­ä¸²å…¨éƒ¨ä¸º&amp;quot;å°å†™&amp;quot;æ—¶å› å­å€¼ä¸º 1ï¼›&lt;/li&gt;
&lt;li&gt;å½“æ•´ä¸ªæ¨¡å¼å­ä¸²å…¨éƒ¨å¤§å†™æ—¶ï¼Œå› ä¸ºå€¼ä¸º 2ï¼Œå› ä¸ºå‡å®šæ”»å‡»è€…å…ˆå°è¯•å…¨éƒ¨å°å†™å†å°è¯•å…¨éƒ¨å¤§å†™ï¼Œæ‰€ä»¥å°è¯•äº†ä¸¤æ¬¡ï¼›&lt;/li&gt;
&lt;li&gt;å…¶ä½™æƒ…å†µä½¿ç”¨å…¬å¼ $\sum_{i=1}^{\min(\text{shifted},\text{unshifted})}\binom{\text{shifted}+\text{unshifted}}{i}$ è®¡ç®—ï¼Œ$shifted$ æ˜¯æŒ‰ä½ shift é”®è¾“å…¥çš„ä¸ªæ•°ï¼Œ$unshifted$ æ˜¯ä¸éœ€è¦æŒ‰ä½ shift é”®è¾“å…¥çš„ä¸ªæ•°ï¼Œè¿™ä¸ªå…¬å¼å°±ä¸å±•å¼€ä»‹ç»äº†ï¼ŒåŸç†ä¸ä¸Šé¢çš„å­—å…¸åŒ¹é…ä¸­çš„å¤§å°å†™æ¨¡å¼è®¡ç®—ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é‡å¤åŒ¹é…&lt;/strong&gt;ï¼šæ•´ä¸ªé‡å¤çš„æ¨¡å¼å­ä¸²ç”± n ä¸ªé‡å¤çš„åŸºç¡€å­—ä¸²ç»„æˆï¼Œå¦‚ &lt;code&gt;nownownow&lt;/code&gt; ç”±åŸºç¡€å­ä¸² &lt;code&gt;now&lt;/code&gt; é‡å¤ 3 æ¬¡ç»„æˆï¼›é‡å¤åŒ¹é…é¦–å…ˆä¼šé€’å½’çš„æ£€æµ‹åŸºç¡€å­ä¸² &lt;code&gt;now&lt;/code&gt; çš„åŒ¹é…æ¨¡å¼ï¼Œå¹¶è®¡ç®—å…¶çŒœæµ‹æ¬¡æ•° $g$ï¼›å­ä¸² &lt;code&gt;now&lt;/code&gt; çš„æ¨¡å¼ä¸ºå­—å…¸æ¨¡å¼ï¼Œåœ¨å­—å…¸è¡¨ä¸­æ’åç¬¬ 42 ä½ï¼Œå­ä¸²é‡å¤äº† 3 æ¬¡ï¼Œæ•´ä¸ªé‡å¤æ¨¡å¼å­ä¸²çš„çŒœæµ‹æ¬¡æ•°ä¸ºï¼š$g\times n$ï¼Œå³ &lt;code&gt;nownownow&lt;/code&gt; çš„çŒœæµ‹æ¬¡æ•°ä¸º $42\times 3$ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•ç†è§£è¿™é‡Œçš„ä¹˜æ³•å‘¢ï¼šå¯†ç  &lt;code&gt;123abcabcabc&lt;/code&gt; ä¸­å­˜åœ¨ä¸€æ®µé‡å¤çš„å­ä¸² &lt;code&gt;abcabcabc&lt;/code&gt;ï¼Œåªçœ‹åŸºç¡€å•å…ƒ &lt;code&gt;abc&lt;/code&gt; æ”»å‡»è€…éœ€è¦å°è¯• $g$ æ¬¡æ‰èƒ½çŒœå¯¹ï¼Œåœ¨çŒœå¯¹åŸºç¡€å•å…ƒåå¯¹äºæ•´ä¸ªé‡å¤å­ä¸² &lt;code&gt;abcabcabc&lt;/code&gt; éœ€è¦å°è¯•å°†åŸºç¡€å•å…ƒé‡å¤ 3 æ¬¡æ‰èƒ½å®Œæ•´åŒ¹é…ä¸­è¿™æ®µå®Œæ•´çš„é‡å¤å­ä¸²ï¼šå°è¯•é‡å¤ &lt;code&gt;abc&lt;/code&gt;ã€å°è¯• &lt;code&gt;abcabc&lt;/code&gt;ã€å°è¯• &lt;code&gt;abcabcabc&lt;/code&gt;ï¼Œå³ä»é‡å¤ 1 æ¬¡ ä¸€ç›´åˆ°é‡å¤ $n$ æ¬¡ï¼Œæ‰€ä»¥è¦çŒœå¯¹è¿™æ®µå®Œæ•´çš„é‡å¤å­ä¸²éœ€è¦çŒœæµ‹ $g\times n$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¡ºåºåŒ¹é…&lt;/strong&gt;ï¼šé¡ºåºåŒ¹é…çš„çŒœæµ‹æ¬¡æ•°è®¡ç®—æ–¹æ³•ä¸ºï¼š$S\cdot N\cdot \lvert d\lvert$ï¼Œ$S$ ä¸ºèµ·å§‹å­—ç¬¦çš„å¯é€‰ä¸ªæ•°ï¼Œ$N$ ä¸ºé•¿åº¦ï¼Œ$d$ ä¸ºç›¸é‚»å‰åå­—ç¬¦çš„ Unicode ç¼–ç å·®å€¼ï¼ˆå¦‚ &lt;code&gt;9753&lt;/code&gt; çš„å‰åå­—ç¬¦å·®å€¼ä¸º -2ï¼‰ã€‚å½“æ¨¡å¼å­ä¸²é¦–å­—ç¬¦ä¸º &lt;code&gt;[&#39;a&#39;,&#39;A&#39;,&#39;z&#39;,&#39;Z&#39;,&#39;0&#39;,&#39;1&#39;,&#39;9&#39;]&lt;/code&gt; ä¸­çš„ä»»ä½•ä¸€ä¸ªæ—¶ï¼Œ$S$ å°†è¢«èµ‹å€¼ä¸º 4ï¼Œå¦‚æœé¦–å­—ç¬¦ä¸åœ¨ä¸Šè¿°åˆ—è¡¨ä¸­ï¼Œä½†æ˜¯é¦–å­—ç¬¦ä¸ºå…¶ä»–æ•°å­—ï¼Œåˆ™ $S$ å°†è¢«èµ‹å€¼ä¸º 10ï¼Œå…¶ä»–æƒ…å†µ $S$ å°†è¢«èµ‹å€¼ä¸º 26ï¼Œå½“å­—ç¬¦åºåˆ—ä¸ºå€’åºæ—¶ï¼Œè¿˜è¦åœ¨ $S\cdot N\cdot \lvert d\lvert$ çš„åŸºç¡€ä¸Šä¹˜ä»¥äºŒ(å› ä¸ºçŒœå®Œæ­£åºè¿˜è¦å†çŒœä¸€æ¬¡å€’å™)ï¼Œå³ $2\cdot S\cdot N\cdot\lvert d\lvert$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ—¥æœŸåŒ¹é…&lt;/strong&gt;ï¼šæ—¥æœŸåŒ¹é…çš„çŒœæµ‹æ¬¡æ•°è®¡ç®—æ–¹æ³•ä¸ºï¼š$365\cdot \lvert now.year-date.year \lvert$ï¼Œå¯ä»¥çœ‹å‡ºè¿™é‡Œçš„è®¡ç®—ä¸ºä¼°ç®—&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æš´åŠ›ç ´è§£åŒ¹é…&lt;/strong&gt;ï¼šæš´åŠ›ç ´è§£çš„çŒœæµ‹æ¬¡æ•°è®¡ç®—æ–¹æ³•ä¸ºï¼š$C^N$ï¼Œ$C$ ä¸ºå¸¸æ•°è¢«èµ‹å€¼ä¸º 10ï¼Œå³å‡è®¾æš´åŠ›ç ´è§£æ—¶æ¯ä¸ªä½ç½®ä¸Šçš„å­—ç¬¦éœ€è¦å°è¯• 10 æ¬¡ï¼Œ$N$ ä¸ºå¯†ç é•¿åº¦&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ­£åˆ™åŒ¹é…&lt;/strong&gt;ï¼šè¯¥æ¨¡å¼åœ¨æœ€ç»ˆçš„&lt;a class=&#34;link&#34; href=&#34;https://github.com/dropbox/zxcvbn/blob/67c4ece9efc40c9d0a1d7d995b2b22a91be500c2/src/scoring.coffee#L288&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ä»£ç å®ç°&lt;/a&gt;ä¸­æœ‰ä½†æ˜¯è®ºæ–‡ä¸­å¹¶æœªæåŠï¼ŒçŒœæµ‹æ¬¡æ•°è®¡ç®—å…¬å¼ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæœ€è¿‘å¹´ä»½çš„æ­£åˆ™ï¼š$\lvert now.year-date.year \lvert$ï¼Œå³å¹´ä»½å·®å€¼çš„ç»å¯¹å€¼&lt;/li&gt;
&lt;li&gt;å¯¹äºå…¶ä»–æ­£åˆ™ï¼š$C^N$ï¼Œ$C$ ä¸ºå¸¸æ•°ï¼Œæ¯ä¸€ç§æ­£åˆ™è¡¨è¾¾å¼éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å¸¸æ•°ï¼Œä»£è¡¨ç ´è§£ä¸€ä½éœ€è¦å°è¯•çš„æ¬¡æ•°ï¼Œ$N$ ä¸ºå¯†ç é•¿åº¦ã€‚å¯ä»¥çœ‹å‡ºæ­¤ç±»åŒ¹é…æ¨¡å¼å…¶å®ä¸æš´åŠ›ç ´è§£åŒ¹é…æ¨¡å¼ç±»ä¼¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;æ•´ä¸ªå¯†ç çš„çŒœæµ‹æ¬¡æ•°è®¡ç®—&#34;&gt;æ•´ä¸ªå¯†ç çš„çŒœæµ‹æ¬¡æ•°è®¡ç®—
&lt;/h3&gt;&lt;p&gt;æ•´ä¸ªçŒœæµ‹è¿‡ç¨‹å¯ç”±ä»¥ä¸‹&lt;a class=&#34;link&#34; href=&#34;https://baike.baidu.com/item/%E5%90%AF%E5%8F%91%E5%BC%8F%E6%90%9C%E7%B4%A2/8944170&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å¯å‘å¼æœç´¢&lt;/a&gt;è¡¨ç¤ºï¼š&lt;/p&gt;
$$
\argmin\limits_{S\subseteq\mathcal{S}}(D^{\lvert S\lvert-1}+\lvert S\lvert!\prod\limits_{m\in S}m.guesses)
$$&lt;p&gt;å…¬å¼å«ä¹‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$\mathcal{S}$ï¼šå¯†ç å­—ç¬¦ä¸²çš„æ‰€æœ‰æ¨¡å¼å­ä¸²çš„é›†åˆï¼Œå¦‚ï¼š&lt;code&gt;[levono(å­—å…¸æ¨¡å¼), eno(å­—å…¸åè½¬æ¨¡å¼), no(å•è¯æ¨¡å¼), no(å•è¯åè½¬æ¨¡å¼), 1111(é‡å¤æ¨¡å¼), 1111(æ—¥æœŸæ¨¡å¼)]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$S$ï¼šé¦–å°¾ç›¸æ¥èƒ½ç»„æˆå¯†ç çš„éé‡å æ¨¡å¼å­ä¸²åºåˆ—ï¼Œå¦‚ï¼š&lt;code&gt;[levono(å­—å…¸æ¨¡å¼), 1111(é‡å¤æ¨¡å¼)]&lt;/code&gt;ï¼Œå¯ä»¥çœ‹å‡º $S$ æ˜¯ $\mathcal{S}$ çš„å­é›†ï¼Œå³ $S\subseteq\mathcal{S}$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\lvert S\lvert$ï¼šé¦–å°¾ç›¸æ¥ç»„æˆå¯†ç çš„æ¨¡å¼å­ä¸²åºåˆ— $S$ çš„é•¿åº¦ï¼Œå³å¯†ç ç”±å‡ æ®µæ¨¡å¼å­ä¸²ç»„æˆï¼Œå¦‚ä¸Šè¿°å­ä¸²åºåˆ—çš„é•¿åº¦ä¸º 2&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$m$ï¼š$S$ ä¸­çš„æŸä¸ªæ¨¡å¼å­ä¸²ï¼Œå¯è¡¨ç¤ºä¸ºï¼š$m\in S$ ï¼›$m.guesses$ ä¸ºè¯¥æ¨¡å¼å­ä¸²çš„æ‰€éœ€çŒœæµ‹æ¬¡æ•°&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\lvert S\lvert!\prod\limits_{m\in S}m.guesses$ï¼šå‡è®¾æ”»å‡»è€…çŸ¥é“å¯†ç ç”± $\lvert S\lvert$ ä¸ªæ¨¡å¼å­ä¸²ç»„æˆï¼Œå³å‡è®¾æ”»å‡»è€…çŸ¥é“å¯†ç ä¸­æ¨¡å¼å­ä¸²çš„æ•°é‡ï¼Œä½†æ˜¯ä¸çŸ¥é“è¿™å‡ ä¸ªæ¨¡å¼å­ä¸²çš„æ’åˆ—é¡ºåºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ¯”å¦‚ä¸€ä¸ªå¯†ç ç”±ï¼šå­—å…¸æ¨¡å¼å­ä¸² Aã€å•è¯æ¨¡å¼å­ä¸² Bã€æ—¥æœŸæ¨¡å¼å­ä¸² D ç»„æˆï¼Œé‚£ä¹ˆè¿™ä¸ªå¯†ç å¯èƒ½ä¸º ABCã€ACBã€BACã€BCAã€CABã€CBAï¼Œå…±æœ‰ 6 ç§ã€‚ç”±æ’åˆ—å…¬å¼ $P_{n}^{m}=\frac{n!}{(n-m)!}$ å¯çŸ¥ä» $\lvert S\lvert$ ä¸ªå…ƒç´ ä¸­é€‰ $\lvert S\lvert$ ä¸ªå…ƒç´ è¿›è¡Œæ’åˆ—ï¼Œå…±æœ‰ $P_{\lvert S\lvert}^{\lvert S\lvert}=\frac{\lvert S\lvert!}{(\lvert S\lvert-\lvert S\lvert)!}=\frac{\lvert S\lvert!}{0!}=\frac{\lvert S\lvert!}{1}={\lvert S\lvert!}$ ç§å¯èƒ½ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¯ä¸ªç»„æˆå¯†ç çš„æ¨¡å¼å­ä¸² $m$ çš„çŒœæµ‹æ¬¡æ•°ä¸º $m.guesses$ï¼Œé‚£ä¹ˆä¸è€ƒè™‘æ¨¡å¼å­ä¸²é¡ºåºæ—¶æ•´ä¸ªå¯†ç çš„çŒœæµ‹æ¬¡æ•°ä¸ºï¼šç»„æˆå¯†ç çš„æ‰€æœ‰æ¨¡å¼å­ä¸²çš„çŒœæµ‹æ¬¡æ•°çš„ç´¯ä¹˜ï¼Œå³ $\prod\limits_{m\in S}m.guesses$ ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±ä¸Šå¯çŸ¥ï¼Œå½“è€ƒè™‘æ¨¡å¼å­ä¸²ä¹‹é—´çš„é¡ºåºæ—¶ï¼Œæ•´ä¸ªå¯†ç çš„çŒœæµ‹æ¬¡æ•°ä¸º $\lvert S\lvert!$ ä¹˜ä»¥ $\prod\limits_{m\in S}m.guesses$ ï¼Œå³ $\lvert S\lvert!\prod\limits_{m\in S}m.guesses$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$D$ï¼šä¸€ä¸ªå¸¸æ•°ï¼Œä¸ºç»éªŒå€¼ï¼Œå³å¹³å‡æ¯ä¸ªæ¨¡å¼å­ä¸²å¤§æ¦‚éœ€è¦çš„çŒœæµ‹æ¬¡æ•°ã€‚æ ¹æ® Dropbox çš„ç»éªŒï¼ŒD ä¸º 1000~10000 æ—¶å…¬å¼è¡¨ç°è¾ƒä¼˜&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$D^{\lvert S\lvert-1}$ï¼šä¸º $\sum_{l=1}^{\lvert S\lvert-1}D^l$çš„è¿‘ä¼¼å€¼ã€‚å‡è®¾æ”»å‡»è€…ä¸çŸ¥é“å¯†ç ç”±å¤šå°‘ä¸ªæ¨¡å¼å­ä¸²ç»„æˆï¼Œæ¯ä¸ªæ¨¡å¼å­ä¸²çš„çŒœæµ‹æ¬¡æ•°å‡å®šä¸º $D$ ï¼Œé‚£ä¹ˆ $l$ ä¸ªæ¨¡å¼å­ä¸²çš„çŒœæµ‹æ¬¡æ•°å³ä¸º $D^l$ ã€‚å‡è®¾æ”»å‡»è€…æ€»æ˜¯ä»è¾ƒå°‘çš„æ¨¡å¼å­ä¸²æ•°é‡å¼€å§‹çŒœæµ‹ï¼Œåœ¨çŒœåˆ°æ­£ç¡®çš„æ¨¡å¼å­ä¸²ä¸ªæ•° $\lvert S\lvert$ å‰ï¼Œæ€»çš„çŒœæµ‹æ¬¡æ•°å³ä¸º $\sum_{l=1}^{|S|-1} D^l = \frac{D(D^{|S|-1} - 1)}{D - 1} \approx D^{|S|-1}$ï¼Œå³å¯è¿‘ä¼¼ç®€åŒ–ä¸º $D^{\lvert S\lvert-1}$ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$D^{\lvert S\lvert-1}+\lvert S\lvert!\prod\limits_{m\in S}m.guesses$ï¼šç°åœ¨ä»æ•´ä½“ä¸Šæ¥çœ‹ï¼Œå‰åŠéƒ¨åˆ†è¡¨ç¤ºï¼šåœ¨çŒœåˆ°æ­£ç¡®çš„æ¨¡å¼å­ä¸²ä¸ªæ•° $\lvert S\lvert$ å‰çš„ç´¯è®¡çŒœæµ‹æ¬¡æ•°ï¼›ååŠéƒ¨åˆ†è¡¨ç¤ºï¼šåœ¨çŒœåˆ°æ­£ç¡®çš„æ¨¡å¼å­ä¸²ä¸ªæ•° $\lvert S\lvert$ åï¼Œä¸çŸ¥é“è¿™å‡ ä¸ªæ¨¡å¼å­ä¸²æ’åˆ—é¡ºåºçš„æƒ…å†µä¸‹éœ€è¦çš„çŒœæµ‹æ¬¡æ•°ï¼›ä¸¤éƒ¨åˆ†ç›¸åŠ å³ä¸ºæ€»çš„çŒœæµ‹æ¬¡æ•°ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\argmin\limits_{S\subseteq\mathcal{S}}(D^{\lvert S\lvert-1}+\lvert S\lvert!\prod\limits_{m\in S}m.guesses)$ï¼šå¯èƒ½å­˜åœ¨å¤šç§é¦–å°¾ç›¸æ¥èƒ½ç»„æˆå¯†ç çš„æ¨¡å¼å­ä¸²çš„ç»„åˆ $S$ï¼ŒçŒœæµ‹æ¬¡æ•°æœ€å°‘çš„ $S$ å³ä¸ºæœ€ä¼˜çš„ç»„åˆï¼Œæ­¤æ—¶çš„çŒœæµ‹æ¬¡æ•°å³ä¸ºæœ€å°çŒœæµ‹æ¬¡æ•°&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»æ•´ä¸ªå…¬å¼ä¸­å¯ä»¥çœ‹å‡ºï¼Œ$D^{\lvert S\lvert-1}$ å’Œ $\lvert S\lvert!$ ä»¥ä¸åŒçš„æ–¹å¼æƒ©ç½šè¿‡äºå¤æ‚çš„æ¨¡å¼å­ä¸²ç»„åˆã€‚å½“ä¸¤ä¸ªä¸åŒé•¿åº¦çš„æ¨¡å¼å­ä¸²ç»„åˆå…·æœ‰ç›¸è¿‘çš„ $\prod\limits_{m\in S}m.guesses$ çŒœæµ‹æ¬¡æ•°æ—¶ï¼Œ$\lvert S\lvert!$ ä¼šå€¾å‘äºè¾ƒçŸ­çš„æ¨¡å¼å­ä¸²ç»„åˆã€‚$D^{\lvert S\lvert-1}$ å€¾å‘äºåå¯¹è¾ƒé•¿çš„æ¨¡å¼å­—ä¸²ç»„åˆï¼Œå³ä½¿å…¶å…·æœ‰è¾ƒå°çš„ $\lvert S\lvert!\prod\limits_{m\in S}m.guesses$ å€¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœç´¢æœ€ä½³æ¨¡å¼ç»„åˆ&#34;&gt;æœç´¢æœ€ä½³æ¨¡å¼ç»„åˆ
&lt;/h2&gt;&lt;p&gt;ç»™å®šä¸€ä¸ªå¯†ç å­—ç¬¦ä¸²çš„æ‰€æœ‰æ¨¡å¼å­ä¸²(æ¨¡å¼å­ä¸²ä¹‹é—´å¯èƒ½å­˜åœ¨é‡å )é›†åˆ $\mathcal{S}$ï¼Œæœ€åä¸€æ­¥æ˜¯ä» $\mathcal{S}$ ä¸­æœç´¢å‡ºä¸å­˜åœ¨é‡å çš„æ¨¡å¼å­ä¸²çš„åºåˆ—ï¼Œä½¿å¾—æ•´ä¸ªåºåˆ—èƒ½å¤Ÿåˆšå¥½è¦†ç›–ä½æ•´ä¸ªå¯†ç ï¼Œå¹¶ä½¿å¾—çŒœæµ‹æ¬¡æ•°æœ€å°ã€‚ä¸‹é¢å°†æè¿°æœç´¢ä½¿ç”¨çš„åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œå¯ä»¥å¾ˆå¥½çš„å®Œæˆæœç´¢ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ’¡ æ•´ä½“æ€æƒ³æ˜¯æœç´¢èƒ½å¤Ÿè¦†ç›–ä»&lt;code&gt;index=0&lt;/code&gt;åˆ°&lt;code&gt;index=K&lt;/code&gt;çš„å¯†ç å­ä¸²ä¸”çŒœæµ‹æ¬¡æ•°æœ€å°çš„æ¨¡å¼å­ä¸²åºåˆ—ã€‚&lt;code&gt;K&lt;/code&gt;ä»&lt;code&gt;0&lt;/code&gt;è¿­ä»£åˆ°&lt;code&gt;password.length-1&lt;/code&gt;ï¼Œè¿›è€Œé€æ¸çš„ä»å±€éƒ¨æœ€ä¼˜è¿­ä»£è‡³æ•´ä½“æœ€ä¼˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ä½¿ç”¨ä¼ªä»£ç é˜è¿°è¯¥ç®—æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç®€å•ä»‹ç»ä¸€ä¸‹å‡ ä¸ªåˆå§‹å€¼ï¼š
&lt;img src=&#34;https://heaciy.com/p/zxcvbn-explained/variables.png&#34;
	width=&#34;748&#34;
	height=&#34;206&#34;
	srcset=&#34;https://heaciy.com/p/zxcvbn-explained/variables_hu_7f7f54a18cbea1e9.png 480w, https://heaciy.com/p/zxcvbn-explained/variables_hu_d4ba36ace9a5070.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Variables&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;363&#34;
		data-flex-basis=&#34;871px&#34;
	
&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è§£é‡Š
&lt;ol&gt;
&lt;li&gt;$n$ ä¸ºå¯†ç å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œ$k$ä¸ºç´¢å¼•å€¼ï¼Œ$k\in{0,1,2,â€¦,password.length-1}$&lt;/li&gt;
&lt;li&gt;$\mathcal B_{opt}$ ä¸ºåå‘æŒ‡é’ˆåˆ—è¡¨ï¼Œç”¨äºè®°å½•å¯†ç ä¸Šæ¯ä¸ªå­—ç¬¦çš„ç›¸å…³æ•°æ®ã€‚$\mathcal B_{opt}[k][l]$ æ˜¯èƒ½è¦†ç›–å¯†ç å­ä¸² password[0~k] ä¸”é•¿åº¦ä¸º $l$ çš„æ¨¡å¼å­ä¸²åºåˆ—ä¸­çš„æœ€åä¸€ä¸ªæ¨¡å¼å­ä¸²(è¯¥å­ä¸²ä»¥ password[k] ç»“å°¾ï¼›è¯¥æ¨¡å¼å­ä¸²åºåˆ—ä¸ºå°¾å­—ç¬¦æ˜¯ password[k] é•¿åº¦æ˜¯ $l$ çš„æ¨¡å¼å­ä¸²åºåˆ—ä¸­çŒœæµ‹æ¬¡æ•°æœ€å°‘çš„å­ä¸²åºåˆ—ï¼Œå³ end=password[k] &amp;amp;&amp;amp; length=l çš„å±€éƒ¨æœ€ä¼˜è§£)&lt;/li&gt;
&lt;li&gt;$\prod_{opt}[k][l]$ ä¸ºä¸Šè¿°æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—ä¸­æ‰€æœ‰æ¨¡å¼å­ä¸²çŒœæµ‹æ¬¡æ•°çš„ç´¯ä¹˜ã€‚&lt;/li&gt;
&lt;li&gt;$l_{opt}$ æ˜¯æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—çš„é•¿åº¦&lt;/li&gt;
&lt;li&gt;$g_{opt}$ ä¸Šè¿°æ¨¡å¼å­ä¸²åºåˆ—çš„çŒœæµ‹æ¬¡æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æœç´¢å‡½æ•°ï¼š
&lt;img src=&#34;https://heaciy.com/p/zxcvbn-explained/search.png&#34;
	width=&#34;750&#34;
	height=&#34;402&#34;
	srcset=&#34;https://heaciy.com/p/zxcvbn-explained/search_hu_b5e6edbf455a53a2.png 480w, https://heaciy.com/p/zxcvbn-explained/search_hu_4950c4bda6afe09f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Search&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;186&#34;
		data-flex-basis=&#34;447px&#34;
	
&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è§£é‡Š
&lt;ol&gt;
&lt;li&gt;K å€¼ä» 0 è¿­ä»£åˆ° n-1ï¼Œå³ä»å¤´åˆ°å°¾éå†å¯†ç ä¸Šçš„æ¯ä¸€ä¸ªå­—ç¬¦
&lt;ol&gt;
&lt;li&gt;ä»¥ K ç´¢å¼•å¯¹åº”å­—ç¬¦ä¸ºç»“å°¾çš„å¯†ç å‰ç¼€å­ä¸²çš„æœ€ä½³çŒœæµ‹æ¬¡æ•°ï¼Œåˆå§‹å€¼èµ‹å€¼ä¸ºæ— é™å¤§&lt;/li&gt;
&lt;li&gt;éå†å¯†ç æ‰€æœ‰æ¨¡å¼å­ä¸² $\mathcal S$ ä¸­ä»¥ $k$ ç»“å°¾çš„æ¨¡å¼å­ä¸² $m$
&lt;ol&gt;
&lt;li&gt;å¦‚æœè¯¥æ¨¡å¼å­ä¸² $m$ çš„èµ·å§‹ä½ç½® $m.i$ å¤§äº 0ï¼Œå³è¯¥æ¨¡å¼å­ä¸²ä¸æ˜¯ä»å¯†ç çš„èµ·å§‹ä½ç½®å¼€å§‹ï¼Œå…¶å‰é¢è¿˜æœ‰å…¶ä»–æ¨¡å¼å­ä¸²
&lt;ol&gt;
&lt;li&gt;éå† $\mathcal B_{opt}$ ä¸­ä»¥ $m.i-1$ ç»“å°¾çš„æ‰€æœ‰æœ€ä½³è§£æ¨¡å¼å­ä¸²åºåˆ—çš„é•¿åº¦å€¼(å±‚çº§æ•°) $l$&lt;/li&gt;
&lt;li&gt;åœ¨ $\mathcal B_{opt}$ ä¸­è®°å½•ä¸‹ä»¥ $k$ ç»“å°¾ï¼Œé•¿åº¦ä¸º $l+1$ çš„æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—çš„ä¿¡æ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å¦‚æœè¯¥æ¨¡å¼å­ä¸² $m$ çš„èµ·å§‹ä½ç½® $m.i$ ä¸º 0
&lt;ol&gt;
&lt;li&gt;åœ¨ $\mathcal B_{opt}$ ä¸­è®°å½•ä¸‹ä»¥ $k$ ç»“å°¾ï¼Œé•¿åº¦ä¸º 1 çš„æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—çš„ä¿¡æ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;åœ¨ $\mathcal B_{opt}$ ä¸­è®°å½•ä¸‹ä»¥ $k$ ç»“å°¾ï¼Œæš´åŠ›ç ´è§£åŒ¹é…çš„æ¨¡å¼å­ä¸²åºåˆ—çš„ä¿¡æ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;è¿”å›å®Œæ•´çš„ $\mathcal B_{opt}$ ä¸­ä»¥ $n-1$ ç»“å°¾çš„æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—çš„çŒœæµ‹æ¬¡æ•°å€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;è¡¥å……æš´åŠ›ç ´è§£åŒ¹é…çš„å‡½æ•°ï¼š
&lt;img src=&#34;https://heaciy.com/p/zxcvbn-explained/bf_update.png&#34;
	width=&#34;740&#34;
	height=&#34;380&#34;
	srcset=&#34;https://heaciy.com/p/zxcvbn-explained/bf_update_hu_5e38730affc1e00e.png 480w, https://heaciy.com/p/zxcvbn-explained/bf_update_hu_e042c209b057ae2.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;bf_update&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;194&#34;
		data-flex-basis=&#34;467px&#34;
	
&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è§£é‡Š
&lt;ol&gt;
&lt;li&gt;æ„å»ºä¸€ä¸ªä» 0 åˆ° $k$ çš„æš´åŠ›ç ´è§£æ¨¡å¼å­ä¸² $m$&lt;/li&gt;
&lt;li&gt;åœ¨ $\mathcal B_{opt}$ ä¸­è®°å½•ä¸‹ä»¥ $k$ ç»“å°¾ï¼Œé•¿åº¦ä¸º 1 çš„æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—çš„ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;éå† $\mathcal B_{opt}$ ä¸­æ‰€æœ‰ä»¥ $k-1$ ç»“å°¾çš„æ¨¡å¼å­ä¸²åºåˆ—ï¼Œå…¶é•¿åº¦ä¸º $l$ï¼Œç»“å°¾çš„æ¨¡å¼å­ä¸²ä¸º $m$
&lt;ol&gt;
&lt;li&gt;å¦‚æœè¯¥æ¨¡å¼å­ä¸² $m$ çš„åŒ¹é…æ–¹å¼ä¸ºæš´åŠ›ç ´è§£
&lt;ol&gt;
&lt;li&gt;æ„å»ºä¸€ä¸ªä» $m.i$ åˆ° $k$ çš„æ¨¡å¼å­ä¸²ï¼Œèµ‹å€¼ç»™æ–°çš„ $m$&lt;/li&gt;
&lt;li&gt;ä»¥ $m$ æ›´æ–°åœ¨ $\mathcal B_{opt}$ ä¸­ä»¥ $k$ ç»“å°¾ï¼Œé•¿åº¦ä¸º $l$ çš„æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—çš„ä¿¡æ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å¦‚æœè¯¥æ¨¡å¼å­ä¸² $m$ çš„åŒ¹é…æ–¹å¼ä¸æ˜¯æš´åŠ›ç ´è§£
&lt;ol&gt;
&lt;li&gt;æ„å»ºä¸€ä¸ªåªæœ‰ $k$ çš„æ¨¡å¼å­ä¸²ï¼Œèµ‹å€¼ç»™æ–°çš„ $m$&lt;/li&gt;
&lt;li&gt;ä»¥ $m$ æ›´æ–°åœ¨ $\mathcal B_{opt}$ ä¸­ä»¥ $k$ ç»“å°¾ï¼Œé•¿åº¦ä¸º $l+1$ çš„æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—çš„ä¿¡æ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;æ›´æ–° $\mathcal B_{opt}$ è¡¨çš„å‡½æ•°ï¼š
æ›´æ–° $\mathcal B_{opt}$ ä¸­ä»¥æ¨¡å¼å­ä¸² $m$ ç»“å°¾é•¿åº¦ä¸º $l$ çš„æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—
&lt;img src=&#34;https://heaciy.com/p/zxcvbn-explained/update.png&#34;
	width=&#34;741&#34;
	height=&#34;392&#34;
	srcset=&#34;https://heaciy.com/p/zxcvbn-explained/update_hu_e29905b910ed9022.png 480w, https://heaciy.com/p/zxcvbn-explained/update_hu_aadefb27cd5c0502.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;update&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;189&#34;
		data-flex-basis=&#34;453px&#34;
	
&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è§£é‡Š
&lt;ol&gt;
&lt;li&gt;å°†æ¨¡å¼å­ä¸² $m$ çš„çŒœæµ‹æ¬¡æ•°èµ‹å€¼ç»™ $\prod$&lt;/li&gt;
&lt;li&gt;å¦‚æœæ¨¡å¼å­ä¸²åºåˆ—çš„é•¿åº¦ $l$ å¤§äº 1ï¼Œå³æ¨¡å¼å­ä¸²åºåˆ—ä»¥ $m$ ç»“å°¾ä½†æ˜¯ $m$ å‰é¢è¿˜æœ‰å…¶ä»–æ¨¡å¼å­ä¸²
&lt;ol&gt;
&lt;li&gt;$\prod$ ç­‰äºè¯¥æ¨¡å¼å­—ä¸²åºåˆ—ä¸­æ‰€æœ‰æ¨¡å¼å­ä¸²çš„çŒœæµ‹æ¬¡æ•°çš„ç´¯ä¹˜å€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å¦‚æœæ¨¡å¼å­ä¸²åºåˆ—çš„é•¿åº¦ $l$ ç­‰äº 1ï¼Œå³è¯¥åºåˆ—ä¸­åªæœ‰ $m$ ä¸€ä¸ªæ¨¡å¼å­ä¸²
&lt;ol&gt;
&lt;li&gt;åˆ™æ¨¡å¼å­ä¸²åºåˆ—çš„çŒœæµ‹å€¼ $\prod$ ç­‰äºå…¶ä¸­å”¯ä¸€çš„æ¨¡å¼å­ä¸² $m$ çš„çŒœæµ‹æ¬¡æ•° $m.guesses$&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä¸Šé¢è®²è§£çš„å¯å‘å¼è®¡ç®—æ•´ä¸ªæ¨¡å¼å­ä¸²åºåˆ—çš„çŒœæµ‹æ¬¡æ•° $g$&lt;/li&gt;
&lt;li&gt;å¦‚æœ $g$ å°äº$g_{opt}=\mathcal B_{opt}[k][l]$
&lt;ol&gt;
&lt;li&gt;$g_{opt}$ èµ‹å€¼ä¸º $g$&lt;/li&gt;
&lt;li&gt;$l_{opt}$ èµ‹å€¼ä¸º $l$&lt;/li&gt;
&lt;li&gt;$\prod_{opt}[k][l]$ èµ‹å€¼ä¸º $\prod$&lt;/li&gt;
&lt;li&gt;$\mathcal B_{opt}[k][l]$ èµ‹å€¼ä¸º $m$&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;ä»å®Œæ•´çš„ $\mathcal B_{opt}$ è¡¨ä¸­é€‰å‡ºè¦†ç›–æ•´ä¸ªå¯†ç ä¸”çŒœæµ‹æ¬¡æ•°æœ€å°çš„æ¨¡å¼å­ä¸²åºåˆ—ï¼š
&lt;img src=&#34;https://heaciy.com/p/zxcvbn-explained/unwind.png&#34;
	width=&#34;743&#34;
	height=&#34;414&#34;
	srcset=&#34;https://heaciy.com/p/zxcvbn-explained/unwind_hu_367a36204d921618.png 480w, https://heaciy.com/p/zxcvbn-explained/unwind_hu_d68ed00dd6ca8974.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;unwind&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;179&#34;
		data-flex-basis=&#34;430px&#34;
	
&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è§£é‡Š&lt;/p&gt;
&lt;p&gt;ç”±å‰ä¸€ä¸ªæ­¥éª¤çŸ¥æœ€ä½³æ¨¡å¼å­ä¸²åºåˆ—çš„é•¿åº¦ä¸º $l_{opt}$ï¼Œäºæ˜¯ä» $\mathcal B_{opt}[k][l_{opt}]$ ä¸æ–­å‘å‰å€’æ¨ä¾¿èƒ½å¾—åˆ°å®Œæ•´çš„æœ€ä½³çš„æ¨¡å¼å­ä¸²åºåˆ—ï¼ˆåŠ¨æ€è§„åˆ’â€”â€”ä»å±€éƒ¨æœ€ä¼˜ä¸­æœç´¢å‡ºæ•´ä½“æœ€ä¼˜ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ ¹æ®æœ€ç»ˆè¯„ä¼°å‡ºçš„å¯†ç çŒœæµ‹æ¬¡æ•°ï¼Œä¼šå°†å¯†ç åˆ†ä¸ºå››ä¸ªç­‰çº§ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;public&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;guessesToScore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DELTA&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guesses&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1e3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DELTA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guesses&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1e6&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DELTA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guesses&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1e8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DELTA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guesses&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;1e10&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DELTA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://medium.com/nulab/five-algorithms-to-measure-real-password-strength-bd30126e82cc&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Five Algorithms to Measure Real Password Strength&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://dropbox.tech/security/zxcvbn-realistic-password-strength-estimation&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;zxcvbn: realistic password strength estimation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/wheeler&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;zxcvbn: Low-Budget Password Strength Estimation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/nulab/zxcvbn4j&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github: zxcvbn4j&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/dropbox/zxcvbn&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github: zxcvbn&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>Libpcapæ ¼å¼pcapåŒ…åˆ†æ</title>
        <link>https://heaciy.com/p/analyzing-libpcap-pcap-file/</link>
        <pubDate>Sun, 05 Jan 2025 00:00:00 +0000</pubDate>
        
        <guid>https://heaciy.com/p/analyzing-libpcap-pcap-file/</guid>
        <description>&lt;img src="https://heaciy.com/p/analyzing-libpcap-pcap-file/cover.jpg" alt="Featured image of post Libpcapæ ¼å¼pcapåŒ…åˆ†æ" /&gt;&lt;blockquote&gt;
&lt;p&gt;å‰è¨€ï¼š
å› ä¸ºå·¥ä½œä¸­ç»å¸¸è¦æ¥è§¦åˆ° Pcap è¿™ç§æ–‡ä»¶æ ¼å¼ï¼Œæ— è®ºæ˜¯åˆ©ç”¨å…¶è¿›è¡Œç½‘ç»œæ•°æ®åˆ†æï¼Œè¿˜æ˜¯æµ‹è¯•æ—¶ä½¿ç”¨å…¶è¿›è¡Œæµé‡å›æ”¾ã€‚ä½†æ˜¯ Pcap æ–‡ä»¶çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿé‡Œé¢è£…çš„åˆæ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿè¿™æ˜¯æœ¬æ–‡å°†è¦è§£ç­”çš„ä¸¤ä¸ªæ ¸å¿ƒé—®é¢˜&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;pcap-æ˜¯ä»€ä¹ˆ&#34;&gt;Pcap æ˜¯ä»€ä¹ˆ
&lt;/h2&gt;&lt;p&gt;Pcap æ˜¯ Packet Capture çš„ç¼©å†™ï¼Œå³ç½‘ç»œæ•°æ®åŒ…æ•è·ã€‚å°†æ•è·çš„æ•°æ®åŒ…æŒ‰ç…§ä¸€å®šæ ¼å¼å­˜å…¥æ–‡ä»¶å³ Pcap æ–‡ä»¶ã€‚åœ¨ Linux å¹³å°ä¸Šä½¿ç”¨ Tcpdumpï¼Œåœ¨ Windows ä¸Šä½¿ç”¨ Wireshark æŠ“åŒ…ï¼Œå¯ä»¥ä¿å­˜ä¸º .pcap åç¼€çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ’¡å®é™…ä¸Š Pcap æ–‡ä»¶å­˜åœ¨å¤šç§æ ¼å¼ï¼Œæœ€å¸¸ç”¨çš„ä¸¤ç§æ ¼å¼ä¸º &lt;a class=&#34;link&#34; href=&#34;https://wiki.wireshark.org/Development/LibpcapFileFormat&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Libpcap&lt;/a&gt; å’Œ &lt;a class=&#34;link&#34; href=&#34;https://wiki.wireshark.org/Development/PcapNg&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PcapNG(PCAP Next Generation)&lt;/a&gt; æ ¼å¼ï¼Œ&lt;strong&gt;æœ¬æ–‡ä¸»è¦è®²è§£ Libpcap æ ¼å¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Libpcap æ ¼å¼æœ€æ–°è‰æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-pcap#section-4-5.4.1&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-pcap&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/IETF-OPSAWG-WG/draft-ietf-opsawg-pcap&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/IETF-OPSAWG-WG/draft-ietf-opsawg-pcap&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Wireshark è¯´æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.wireshark.org/FileFormatReference&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://wiki.wireshark.org/FileFormatReference&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.wireshark.org/Development/PcapNg&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://wiki.wireshark.org/Development/PcapNg&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.wireshark.org/Development/LibpcapFileFormat&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://wiki.wireshark.org/Development/LibpcapFileFormat&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;pcap-æ–‡ä»¶çš„æ•°æ®ç»“æ„&#34;&gt;Pcap æ–‡ä»¶çš„æ•°æ®ç»“æ„
&lt;/h2&gt;&lt;h3 id=&#34;æ–‡ä»¶æ•´ä½“æ ¼å¼&#34;&gt;æ–‡ä»¶æ•´ä½“æ ¼å¼
&lt;/h3&gt;&lt;p&gt;Pcap æ–‡ä»¶ç”±ä¸€ä¸ªå…¨å±€çš„å¤´éƒ¨ï¼ˆGlobal Headerï¼‰å’Œé›¶è‡³å¤šä¸ªæ•°æ®åŒ…ï¼ˆPacketï¼Œä¸ç½‘ç»œå±‚çš„ Packet ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼‰ç»„æˆï¼Œå…¨å±€å¤´éƒ¨ä¸»è¦ç”¨äºå­˜å‚¨å­—èŠ‚é¡ºåºã€æ–‡ä»¶ç‰ˆæœ¬ã€å•ä¸ªæ•°æ®åŒ…æœ€å¤§é•¿åº¦ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ•°æ®åŒ…åˆç”± Header å’Œ Data ç»„æˆï¼ŒHeader ä¸­ä¸»è¦ç”¨äºå­˜å‚¨æ—¶é—´æˆ³å’Œ Data çš„é•¿åº¦ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image.png&#34;
	width=&#34;363&#34;
	height=&#34;312&#34;
	srcset=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_hu_955b53d44f76d58c.png 480w, https://heaciy.com/p/analyzing-libpcap-pcap-file/image_hu_33cacc514b224a40.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;image.png&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;116&#34;
		data-flex-basis=&#34;279px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;å…¨å±€å¤´éƒ¨æ ¼å¼global-header&#34;&gt;å…¨å±€å¤´éƒ¨æ ¼å¼ï¼ˆGlobal Headerï¼‰
&lt;/h3&gt;&lt;p&gt;ç°åœ¨æ¥åˆ†æ Pcap æ–‡ä»¶çš„å…¨å±€å¤´éƒ¨ï¼Œæ„é€ ä¿¡æ¯å¦‚ä¸‹ï¼Œæ¯è¡Œ 4 ä¸ªå­—èŠ‚ï¼ˆByteï¼‰å³ 32 æ¯”ç‰¹ï¼ˆbitï¼‰ï¼Œå…¨å±€å¤´éƒ¨å…±è®¡ 24 ä¸ªå­—èŠ‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     0               1               2               3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    0 |                          Magic Number                         |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    4 |          Major Version        |         Minor Version         |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    8 |                           Thiszone                            |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   12 |                            Sigfigs                            |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   16 |                            SnapLen                            |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   20 |                            LinkType                           |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;mermaid&#34; align=&#34;center&#34;&gt;
---
title: &amp;#34;PCAP Global Header&amp;#34;
---
packet-beta
0-31: &amp;#34;Magic Number&amp;#34;
32-47: &amp;#34;Major Version&amp;#34;
48-63: &amp;#34;Minor Version&amp;#34;
64-95: &amp;#34;Thiszone&amp;#34;
96-127: &amp;#34;Sigfigs&amp;#34;
128-159: &amp;#34;SnapLen&amp;#34;
160-191: &amp;#34;LinkType&amp;#34;
&lt;/div&gt;

&lt;p&gt;C è¯­è¨€å®ç°ï¼ˆæ¥è‡ªWireshark æ–‡æ¡£ï¼‰ï¼Œ&lt;a class=&#34;link&#34; href=&#34;https://github.com/the-tcpdump-group/libpcap/blob/15021c447e82edb2442c46eb72027d905a534c81/pcap/pcap.h#L204&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Github ä¸Š Libpcap çš„æœ€æ–°å®ç°ç•¥æœ‰ä¸åŒï¼Œä¸è¿‡æ— å®è´¨å·®åˆ«ï¼Œå…·ä½“è§é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pcap_hdr_s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;magic_number&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;   &lt;span class=&#34;cm&#34;&gt;/* magic number */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint16&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;version_major&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;cm&#34;&gt;/* major version number */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint16&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;version_minor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;cm&#34;&gt;/* minor version number */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;gint32&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;thiszone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;       &lt;span class=&#34;cm&#34;&gt;/* GMT to local correction */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sigfigs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;        &lt;span class=&#34;cm&#34;&gt;/* accuracy of timestamps */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;snaplen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;        &lt;span class=&#34;cm&#34;&gt;/* max length of captured packets, in octets */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;network&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;        &lt;span class=&#34;cm&#34;&gt;/* data link type */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;pcap_hdr_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç›¸å…³å­—æ®µè§£é‡Šå¦‚ä¸‹è¡¨ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å­—æ®µ&lt;/th&gt;
          &lt;th&gt;å­—èŠ‚æ•°&lt;/th&gt;
          &lt;th&gt;å«ä¹‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Magic Number&lt;br /&gt;&lt;code&gt;magic_number&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;åå…­è¿›åˆ¶æ•°å­—&lt;code&gt;0xA1 B2 C3 D4&lt;/code&gt;ï¼Œæ ‡è®°æ–‡ä»¶å¼€å§‹ï¼Œå¹¶ç”¨æ¥è¯†åˆ«æ–‡ä»¶çš„å­—èŠ‚é¡ºåºã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Major Version&lt;br /&gt;&lt;code&gt;version_major&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;ä¸€ä¸ªæ— ç¬¦å·å€¼ï¼Œç»™å‡º pcap æ ¼å¼çš„å½“å‰ä¸»è¦ç‰ˆæœ¬çš„ç¼–å·ï¼Œä¸€èˆ¬ä¸º2ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Minor Version&lt;br /&gt;&lt;code&gt;version_minor&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;ä¸€ä¸ªæ— ç¬¦å·å€¼ï¼Œç»™å‡º pcap æ ¼å¼çš„å½“å‰æ¬¡è¦ç‰ˆæœ¬çš„ç¼–å·ï¼Œä¸€èˆ¬ä¸º4ã€‚ï¼ˆä¸ä¸Šé¢çš„ Major Version ä¸€èµ·ç»„æˆç‰ˆæœ¬å· 2.4 ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ThisZone&lt;br /&gt;&lt;code&gt;thiszone&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;å½“åœ°çš„æ ‡å‡†æ—¶é—´ï¼Œå¦‚æœç”¨çš„æ˜¯UTCåˆ™å…¨é›¶ï¼Œä¸€èˆ¬å…¨é›¶ï¼ˆåœ¨æœ€æ–°çš„æ ‡å‡†ä¸­å·²å¼ƒç”¨ï¼Œå› ä¸ºç°åœ¨éƒ½ä½¿ç”¨UTCæ—¶é—´ï¼Œä¸ºå‘ä¸‹å…¼å®¹è®¾ç½®ä¸ºå…¨0ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;SigFigs&lt;br /&gt;&lt;code&gt;sigfigs&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;æ—¶é—´æˆ³çš„ç²¾åº¦ï¼Œä¸€èˆ¬å…¨é›¶ï¼ˆåœ¨æœ€æ–°çš„æ ‡å‡†ä¸­å·²å¼ƒç”¨ï¼Œä¸ºå‘ä¸‹å…¼å®¹è®¾ç½®ä¸ºå…¨0ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;SnapLen&lt;br /&gt;&lt;code&gt;snaplen&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;è®¾ç½®æ‰€æŠ“è·çš„å•ä¸ªæ•°æ®åŒ…çš„æœ€å¤§é•¿åº¦ï¼Œä¸€èˆ¬è®¾ç½®ä¸º65535ï¼ˆå•ä¸ªæ•°æ®é“¾è·¯å±‚å¸§å¤§å°ä¸€èˆ¬ä¸º1518å­—èŠ‚åŒ…æ‹¬14å­—èŠ‚é¦–éƒ¨å’Œ4å­—èŠ‚å°¾éƒ¨ï¼Œä½†æ˜¯å·¨å¸§å¯è¾¾9000å­—èŠ‚ç”šè‡³æ›´å¤šï¼Œè®¾ç½®ä¸º65535å¤§äºä»»ä½•æ ‡å‡†æˆ–å·¨å‹ä»¥å¤ªç½‘å¸§çš„å¤§å°ï¼Œå®ƒæä¾›äº†è¶³å¤Ÿçš„ç©ºé—´æ¥æ•è·å‡ ä¹æ‰€æœ‰ç±»å‹çš„ç½‘ç»œæ•°æ®åŒ…ï¼ŒåŒ…æ‹¬éæ ‡å‡†æˆ–å®éªŒæ€§åè®®ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;LinkType&lt;br /&gt;&lt;code&gt;network&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;æ•°æ®é“¾è·¯å±‚åè®®ç±»å‹ã€‚è§£ææ•°æ®åŒ…é¦–å…ˆè¦åˆ¤æ–­å®ƒçš„LinkTypeï¼Œæ‰€ä»¥è¿™ä¸ªå€¼å¾ˆé‡è¦ã€‚å¸¸è§çš„å€¼å¦‚ 1ï¼Œä»£è¡¨ç€ä»¥å¤ªç½‘ã€‚&lt;a class=&#34;link&#34; href=&#34;https://www.tcpdump.org/linktypes.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ç›¸å…³å®šä¹‰å’Œæšä¸¾å€¼è§å‚è€ƒé“¾æ¥&lt;/a&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ğŸ’¡æ³¨æ„ï¼šå¯¹äº Magic Numberï¼Œåœ¨å…¶ä»–åœ°æ–¹æˆ–è®¸ä¼šçœ‹åˆ°æœ‰äººè¯´é™¤äº†&lt;code&gt;0x A1 B2 C3 D4&lt;/code&gt;è¿˜æœ‰&lt;code&gt;0x A1 B2 3C 4D&lt;/code&gt;ï¼Œåœ¨&lt;a class=&#34;link&#34; href=&#34;https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-pcap#name-file-header&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è¾ƒæ–°çš„ç‰ˆæœ¬ä¸­&lt;/a&gt;ç¡®å®å­˜åœ¨&lt;code&gt;A1 B2 3C 4D&lt;/code&gt;ï¼ˆå¤§ç«¯æ¨¡å¼ï¼‰æˆ–è€…&lt;code&gt;4D 3C B2 A1&lt;/code&gt;ï¼ˆå°ç«¯æ¨¡å¼ï¼‰çš„æƒ…å†µï¼Œç”¨äºæ ‡è®° Packet Header ä¸­æ—¶é—´æˆ³çš„ç²¾åº¦ä¸ºçº³ç§’ã€‚&lt;/p&gt;
&lt;p&gt;æ•…ä» Pcap æ–‡ä»¶çš„ä½ä½åˆ°é«˜ä½åº¦è¯»å–ï¼Œå­˜åœ¨ä»¥ä¸‹å››ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;A1 B2 C3 D4&lt;/code&gt;ï¼šå¤§ç«¯æ¨¡å¼ï¼ŒPacket Header ä¸­æ—¶é—´æˆ³ä¸ºæ¯«ç§’ç²¾åº¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;D4 C3 B2 A1&lt;/code&gt;ï¼šå°ç«¯æ¨¡å¼ï¼ŒPacket Header ä¸­æ—¶é—´æˆ³ä¸ºæ¯«ç§’ç²¾åº¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;A1 B2 3C 4D&lt;/code&gt;ï¼šå¤§ç«¯æ¨¡å¼ï¼ŒPacket Header ä¸­æ—¶é—´æˆ³ä¸ºçº³ç§’ç²¾åº¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;4D 3C B2 A1&lt;/code&gt;ï¼šå°ç«¯æ¨¡å¼ï¼ŒPacket Header ä¸­æ—¶é—´æˆ³ä¸ºçº³ç§’ç²¾åº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;â—ï¸ ç½‘ä¸Šçš„å¾ˆå¤šæ–‡æ¡£æ··æ·†äº†å¤§å°ç«¯å’Œæ—¶é—´æˆ³ç²¾åº¦ï¼Œæ³¨æ„ç”„åˆ«&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æœ€æ–°è‰æ¡ˆä¸­ï¼Œå…¨å±€å¤´éƒ¨çš„æœ€åå››å­—èŠ‚æ•°æ®ä¹Ÿæœ‰æ‰€å˜åŒ–ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹&lt;/p&gt;
&lt;h3 id=&#34;æ•°æ®åŒ…å¤´éƒ¨æ ¼å¼packet-header&#34;&gt;æ•°æ®åŒ…å¤´éƒ¨æ ¼å¼ï¼ˆPacket Headerï¼‰
&lt;/h3&gt;&lt;p&gt;æ•°æ®åŒ…æ„é€ ä¿¡æ¯å¦‚ä¸‹ï¼Œæ¯è¡Œ 4 ä¸ªå­—èŠ‚ï¼ˆByteï¼‰å³ 32 æ¯”ç‰¹ï¼ˆbitï¼‰ï¼Œæ¯ä¸ªæ•°æ®åŒ…å¤´éƒ¨å…±è®¡ 16 ä¸ªå­—èŠ‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     0               1               2               3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    0 |                      Timestamp (Seconds)                      |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    4 |                   Timestamp (Microseconds)                    |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    8 |                    Captured Packet Length                     |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   12 |                    Original Packet Length                     |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   16 /                                                               /
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      /                          Packet Data                          /
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      /                        variable length                        /
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      /                                                               /
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +---------------------------------------------------------------+
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;mermaid&#34; align=&#34;center&#34;&gt;
---
title: &amp;#34;PCAP Packet Record&amp;#34;
---

packet-beta
0-31: &amp;#34;Timestamp (Seconds)&amp;#34;
32-63: &amp;#34;Timestamp (Microseconds)&amp;#34;
64-95: &amp;#34;Captured Packet Length&amp;#34;
96-127: &amp;#34;Original Packet Length&amp;#34;
128-191: &amp;#34;Packet Data (variable length)&amp;#34; 
&lt;/div&gt;

&lt;p&gt;C è¯­è¨€å®ç°ï¼ˆæ¥è‡ªWireshark æ–‡æ¡£ï¼‰ï¼Œ&lt;a class=&#34;link&#34; href=&#34;https://github.com/the-tcpdump-group/libpcap/blob/15021c447e82edb2442c46eb72027d905a534c81/pcap/pcap.h#L299&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Github ä¸Š Libpcap çš„æœ€æ–°å®ç°ç•¥æœ‰ä¸åŒï¼Œä¸è¿‡æ— å®è´¨å·®åˆ«ï¼Œå…·ä½“è§é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pcaprec_hdr_s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ts_sec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;         &lt;span class=&#34;cm&#34;&gt;/* timestamp seconds */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ts_usec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;        &lt;span class=&#34;cm&#34;&gt;/* timestamp microseconds */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;incl_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;       &lt;span class=&#34;cm&#34;&gt;/* number of octets of packet saved in file */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;guint32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;orig_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;       &lt;span class=&#34;cm&#34;&gt;/* actual length of packet */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;pcaprec_hdr_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç›¸å…³å­—æ®µè§£é‡Šå¦‚ä¸‹è¡¨ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å­—æ®µ&lt;/th&gt;
          &lt;th&gt;å­—èŠ‚æ•°&lt;/th&gt;
          &lt;th&gt;å«ä¹‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Timestamp(Seconds)&lt;br /&gt;&lt;code&gt;ts_sec&lt;/code&gt;&lt;br /&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;ç§’çº§æ—¶é—´æˆ³ï¼Œç§’å€¼æ˜¯ä¸€ä¸ª 32 ä½æ— ç¬¦å·æ•´æ•°ï¼Œè¡¨ç¤ºè‡ª 1970 å¹´ 1 æœˆ 1 æ—¥ 00:00:00 UTC ä»¥æ¥ç»è¿‡çš„ç§’æ•°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Timestamp(Microseconds)&lt;br /&gt;&lt;code&gt;ts_usec&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;å¾®ç§’å€¼è¡¨ç¤ºè‡ªç§’å€¼ä¹‹åç»è¿‡çš„å¾®ç§’(å¯ä»¥ç†è§£ä¸ºç§’æ•°å°æ•°ç‚¹åçš„æ•°)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Captured Packet Length&lt;br /&gt;&lt;code&gt;incl_len&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;ä¸€ä¸ªæ— ç¬¦å·å€¼ï¼Œè¡¨ç¤ºä»ç½‘ç»œä¸­å®é™…ä¸­æ•è·çš„å­—èŠ‚æ•°ï¼ˆå³ Packet Data çš„é•¿åº¦ï¼‰ã€‚å®ƒçš„å€¼ä¸ºåŸå§‹æ•°æ®åŒ…é•¿åº¦ï¼ˆOriginal Packet Lengthï¼‰å’Œå¿«ç…§é•¿åº¦ï¼ˆä¸Šè¡¨ä¸­çš„ SnapLenï¼‰ä¸­çš„è¾ƒå°å€¼ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Original Packet Length&lt;br /&gt;&lt;code&gt;orig_len&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;ä¸€ä¸ªæ— ç¬¦å·å€¼ï¼Œè¡¨ç¤ºæ•°æ®åŒ…åœ¨ç½‘ç»œä¸Šä¼ è¾“æ—¶çš„å®é™…é•¿åº¦ã€‚å¦‚æœæ•°æ®åŒ…åœ¨æ•è·è¿‡ç¨‹ä¸­è¢«æˆªæ–­ï¼Œåˆ™æ•è·çš„æ•°æ®åŒ…é•¿åº¦ä¸å®é™…ç½‘ç»œä¸­ä¼ è¾“çš„æ•°æ®åŒ…é•¿åº¦ä¸åŒã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Packet Data&lt;br /&gt;&lt;code&gt;data&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ç”±ä¸Šè¿° Captured Packet Length å­—æ®µå†³å®š&lt;/td&gt;
          &lt;td&gt;å®é™…è¢«æ•è·çš„æ•°æ®é“¾è·¯å±‚å¸§ï¼ŒåŒ…æ‹¬é“¾è·¯å±‚æ ‡å¤´ã€‚è¯¥å­—æ®µçš„å®é™…é•¿åº¦ä¸º Captured Packet Lengthã€‚é“¾è·¯å±‚å¤´éƒ¨çš„æ ¼å¼å–å†³äºæ–‡ä»¶å…¨å±€å¤´éƒ¨ä¸­æŒ‡å®šçš„ LinkType å­—æ®µã€‚å¯ä»¥ç†è§£ä¸ºï¼šæ¯ä¸€ä¸ª Packet ä¸­éƒ½è£…ç€ä¸€ä¸ªæ•°æ®é“¾å±‚çš„å¸§ã€‚&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;ä½¿ç”¨-imhex-æŸ¥çœ‹-pcap-åŒ…&#34;&gt;ä½¿ç”¨ ImHex æŸ¥çœ‹ Pcap åŒ…
&lt;/h2&gt;&lt;p&gt;ç»è¿‡ä¸Šæ–‡çš„ä»‹ç»æˆ‘ä»¬çŸ¥é“äº† Pcap æ–‡ä»¶çš„å…¨å±€å¤´éƒ¨æ ¼å¼å’Œæ•°æ®åŒ…å¤´éƒ¨æ ¼å¼ï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨å¼€å§‹æŸ¥çœ‹å’Œåˆ†æä¸€ä¸ªå®é™…çš„ Pcap æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_1.png&#34;
	width=&#34;710&#34;
	height=&#34;559&#34;
	srcset=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_1_hu_4260d2d8934faeef.png 480w, https://heaciy.com/p/analyzing-libpcap-pcap-file/image_1_hu_5b2fcac9947f68e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å›¾ 3.1ï¼šä½¿ç”¨ ImHex æ‰“å¼€ Pcap æ–‡ä»¶&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;127&#34;
		data-flex-basis=&#34;304px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 3.1ï¼šä½¿ç”¨ ImHex æ‰“å¼€ Pcap æ–‡ä»¶&lt;/p&gt;
&lt;h3 id=&#34;å…¨å±€å¤´éƒ¨&#34;&gt;å…¨å±€å¤´éƒ¨
&lt;/h3&gt;&lt;p&gt;æ ¹æ®ä¸Šè¿°ç« èŠ‚çš„åˆ†æå¯çŸ¥å…¨å±€å¤´éƒ¨å 24ä¸ªå­—èŠ‚ï¼Œäºæ˜¯è®©æˆ‘ä»¬åˆ†æä¸Šè¿° Pcap æ–‡ä»¶çš„å‰24ä¸ªå­—èŠ‚ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_2.png&#34;
	width=&#34;722&#34;
	height=&#34;85&#34;
	srcset=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_2_hu_c909d844df1188b3.png 480w, https://heaciy.com/p/analyzing-libpcap-pcap-file/image_2_hu_58ecfd60deaea0a8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å›¾ 3.1.1ï¼šPcap æ–‡ä»¶çš„å…¨å±€å¤´éƒ¨&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;849&#34;
		data-flex-basis=&#34;2038px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 3.1.1ï¼šPcap æ–‡ä»¶çš„å…¨å±€å¤´éƒ¨&lt;/p&gt;
&lt;p&gt;å…·ä½“å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;D4 C3 B2 A1 02 00 04 00 00 00 00 00 00 00 00 00 FF FF 00 00 01 00 00 00
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å‰å››ä¸ªå­—èŠ‚ä¸º Magic Numberï¼Œä»ä½åœ°å€åˆ°é«˜åœ°å€ä¾æ¬¡ä¸º D4 C3 B2 A1ï¼Œç”±ä¸Šè¿°ç« èŠ‚å¯çŸ¥è¯¥ Pcap æ–‡ä»¶çš„å­—èŠ‚é¡ºåºä¸ºå°ç«¯åºï¼Œé‚£ä¹ˆå¯¹äºå¤šå­—èŠ‚æ•°æ®éœ€è¦å€’æ’å­—èŠ‚æ‰èƒ½å¾—åˆ°å®é™…çš„æ•°æ®ï¼Œå…·ä½“æ•°æ®è½¬æ¢å¦‚ä¸‹è¡¨ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å­—æ®µ&lt;/th&gt;
          &lt;th&gt;å­—èŠ‚åºå·&lt;/th&gt;
          &lt;th&gt;å°ç«¯åºæ•°æ®&lt;/th&gt;
          &lt;th&gt;å¤§ç«¯åºæ•°æ®&lt;/th&gt;
          &lt;th&gt;å®é™…æ•°æ®(ç”±å¤§ç«¯åºè®¡ç®—)&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Magic Number(4B)&lt;/td&gt;
          &lt;td&gt;0-3&lt;/td&gt;
          &lt;td&gt;0xD4 C3 B2 A1&lt;/td&gt;
          &lt;td&gt;0xA1 B2 C3 D4&lt;/td&gt;
          &lt;td&gt;LE å°ç«¯æ¨¡å¼æ ‡è®°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Major Version(2B)&lt;/td&gt;
          &lt;td&gt;4-5&lt;/td&gt;
          &lt;td&gt;0x02 00&lt;/td&gt;
          &lt;td&gt;0x00 02&lt;/td&gt;
          &lt;td&gt;2&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Minor Version(2B)&lt;/td&gt;
          &lt;td&gt;6-7&lt;/td&gt;
          &lt;td&gt;0x04 00&lt;/td&gt;
          &lt;td&gt;0x00 04&lt;/td&gt;
          &lt;td&gt;4&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ThisZone(4B)&lt;/td&gt;
          &lt;td&gt;8-11&lt;/td&gt;
          &lt;td&gt;0x00 00 00 00&lt;/td&gt;
          &lt;td&gt;0x00 00 00 00&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;SigFigs(4B)&lt;/td&gt;
          &lt;td&gt;12-15&lt;/td&gt;
          &lt;td&gt;0x00 00 00 00&lt;/td&gt;
          &lt;td&gt;0x00 00 00 00&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;SnapLen(4B)&lt;/td&gt;
          &lt;td&gt;16-19&lt;/td&gt;
          &lt;td&gt;0xFF FF 00 00&lt;/td&gt;
          &lt;td&gt;0x00 00 FF FF&lt;/td&gt;
          &lt;td&gt;65535&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;LinkType(4B)&lt;/td&gt;
          &lt;td&gt;20-23&lt;/td&gt;
          &lt;td&gt;0x01 00 00 00&lt;/td&gt;
          &lt;td&gt;0x00 00 00 01&lt;/td&gt;
          &lt;td&gt;LINKTYPE_ETHERNET ä»¥å¤ªç½‘&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;æ•°æ®åŒ…å¤´éƒ¨&#34;&gt;æ•°æ®åŒ…å¤´éƒ¨
&lt;/h3&gt;&lt;p&gt;æ ¹æ®ä¸Šè¿°ç« èŠ‚å¯çŸ¥ï¼Œæ•°æ®åŒ…å¤´éƒ¨ä¸º 16 å­—èŠ‚ï¼Œé‚£ä¹ˆå…¨å±€å¤´åé¢çš„16ä¸ªå­—èŠ‚å³ä¸º Pcap æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„å¤´éƒ¨ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_3.png&#34;
	width=&#34;553&#34;
	height=&#34;130&#34;
	srcset=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_3_hu_571ee2c11587a32d.png 480w, https://heaciy.com/p/analyzing-libpcap-pcap-file/image_3_hu_ddd093c01529a9d3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å›¾ 3.2.1ï¼šPcpa æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„å¤´éƒ¨ä¿¡æ¯&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;425&#34;
		data-flex-basis=&#34;1020px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 3.2.1ï¼šPcpa æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„å¤´éƒ¨ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;å…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;1F 90 D1 66 69 B3 07 00 36 00 00 00 36 00 00 00
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¾æ¬¡åˆ†æï¼Œæ•°æ®åŒ…å¤´ç”±å››ä¸ªå­—æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µ 4 ä¸ªå­—èŠ‚ï¼Œå…·ä½“æ•°æ®è½¬æ¢å¦‚ä¸‹è¡¨ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å­—æ®µ&lt;/th&gt;
          &lt;th&gt;å­—èŠ‚åºå·&lt;/th&gt;
          &lt;th&gt;å°ç«¯åºæ•°æ®&lt;/th&gt;
          &lt;th&gt;å¤§ç«¯åºæ•°æ®&lt;/th&gt;
          &lt;th&gt;å®é™…æ•°æ®(ç”±å¤§ç«¯åºè®¡ç®—)&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Timestamp(Seconds)(4B)&lt;/td&gt;
          &lt;td&gt;24-27&lt;/td&gt;
          &lt;td&gt;0x1F 90 D1 66&lt;/td&gt;
          &lt;td&gt;0x66 D1 90 1F&lt;/td&gt;
          &lt;td&gt;1725009951&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Timestamp(Microseconds)(4B)&lt;/td&gt;
          &lt;td&gt;28-31&lt;/td&gt;
          &lt;td&gt;0x69 B3 07 00&lt;/td&gt;
          &lt;td&gt;0x00 07 B3 69&lt;/td&gt;
          &lt;td&gt;504681&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Captured Packet Length(4B)&lt;/td&gt;
          &lt;td&gt;32-35&lt;/td&gt;
          &lt;td&gt;0x36 00 00 00&lt;/td&gt;
          &lt;td&gt;0x00 00 00 36&lt;/td&gt;
          &lt;td&gt;54&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Original Packet Length(4B)&lt;/td&gt;
          &lt;td&gt;36-39&lt;/td&gt;
          &lt;td&gt;0x36 00 00 00&lt;/td&gt;
          &lt;td&gt;0x00 00 00 36&lt;/td&gt;
          &lt;td&gt;54&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ç§’çº§æ—¶é—´æˆ³ä¸º 1725009951ï¼Œå¾®å¦™ç²¾åº¦å€¼ä¸º 504681ï¼Œå› æ­¤å®Œæ•´çš„ç§’çº§æ—¶é—´æˆ³ä¸º1725009951.504691ï¼Œè½¬æ¢ä¸ºUTC +8æ—¶é—´ä¸ºï¼š2024-08-30 17:25:51&lt;/p&gt;
&lt;p&gt;æ•°æ®åŒ…æ•è·é•¿åº¦ï¼ˆCaptured Packet Lengthï¼‰å’Œç½‘ç»œä¸Šè¯¥åŒ…å®é™…é•¿åº¦ï¼ˆOriginal Packet Lengthï¼‰æ˜¯ç›¸åŒçš„è¯´æ˜ç½‘ç»œä¸Šçš„æ•°æ®åŒ…è¢«å®Œæ•´æ•è·ã€‚æ„å‘³ç€æ­¤ Packet Header å¯¹åº”çš„ Packet Data çš„é•¿åº¦ä¸º 54 å­—èŠ‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ•°æ®åŒ…è´Ÿè½½&#34;&gt;æ•°æ®åŒ…è´Ÿè½½
&lt;/h3&gt;&lt;p&gt;ç”±ä¸Šè¿°ä¿¡æ¯å¯çŸ¥ç¬¬ä¸€ä¸ª Packet æ•°æ®åŒ…çš„æ•°æ®ä½“é•¿åº¦ä¸º 54 å­—èŠ‚ï¼Œå› æ­¤ä»è¯¥æ•°æ®åŒ…åŒ…å¤´çš„æœ€åä¸€ä¸ªå­—èŠ‚åå‘åè¯»å– 54 å­—èŠ‚å³ä¸ºç¬¬ä¸€ä¸ª Packet æ•°æ®åŒ…çš„æ•°æ®ä½“ã€‚&lt;/p&gt;
&lt;p&gt;å¾ªç¯ä¸Šè¿°æµå¼è¯»å–è¿‡ç¨‹ï¼ˆå…ˆè¯»å–å…¨å±€å¤´éƒ¨ 24 å­—èŠ‚ï¼Œè¯»å–Packet æ•°æ®åŒ…å¤´éƒ¨ 16 å­—èŠ‚ï¼Œè¯»å– Packet åŒ…å¤´ï¼ˆPacket Headerï¼‰ä¸­å­—æ®µ Captured Packet Length è®°å½•é•¿åº¦çš„æ•°æ®ä½œä¸ºæ•°æ®ä½“ï¼ˆPacket Dataï¼‰ï¼Œè¯»å–ç¬¬äºŒä¸ªåŒ…å¤´ï¼Œè¯»å–ç¬¬äºŒä¸ªæ•°æ®ä½“â€¦â€¦ï¼‰&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„ä¸€ä¸ªä¸ª Packet æ•°æ®åŒ…ï¼Œä¾¿å¯¹åº”ç€ Wireshark å·¥å…·ä¸­çš„ä¸€æ¡æ¡è®°å½•ï¼Œç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨ ImHex å’Œ Wireshark æŸ¥çœ‹è¯¥  Pcap æ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„æ•°æ®ä½“ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_4.png&#34;
	width=&#34;557&#34;
	height=&#34;174&#34;
	srcset=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_4_hu_4654566fc4115971.png 480w, https://heaciy.com/p/analyzing-libpcap-pcap-file/image_4_hu_83d9f089712059a3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å›¾ 3.3.1 ä½¿ç”¨ ImHex æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„æ•°æ®ä½“&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;320&#34;
		data-flex-basis=&#34;768px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 3.3.1 ä½¿ç”¨ ImHex æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„æ•°æ®ä½“&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_5.png&#34;
	width=&#34;2048&#34;
	height=&#34;936&#34;
	srcset=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_5_hu_feb69f355e37cb6a.png 480w, https://heaciy.com/p/analyzing-libpcap-pcap-file/image_5_hu_71b985ab1891ef92.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å›¾ 3.3.2 ä½¿ç”¨ Wireshark æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ•°æ®åŒ…&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;218&#34;
		data-flex-basis=&#34;525px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 3.3.2 ä½¿ç”¨ Wireshark æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ•°æ®åŒ…&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºå›¾ 3.3.1 ä¸­é€‰ä¸­çš„ 54 å­—èŠ‚æ•°æ®ï¼Œä¸å›¾ 3.3.2 ä¸­æœ€ä¸‹é¢æ˜¾ç¤ºçš„ 54 å­—èŠ‚æ•°æ®ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè¿™ 54 å­—èŠ‚æ•°æ®æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä»¥åŠä¸ºä»€ä¹ˆæ˜¯ 54 å­—èŠ‚è€Œä¸æ˜¯å…¶ä»–æ•°å­—å‘¢ï¼Ÿå¯¹ç½‘ç»œæ¯”è¾ƒç†Ÿæ‚‰çš„æœ‹å‹å¯èƒ½å·²ç»çŸ¥é“ç­”æ¡ˆäº†ï¼š54 = 14 + 20 + 20ï¼›ä¸‹é¢è®©æˆ‘ä»¬æŒ‰ç…§ç½‘ç»œåè®®æ ˆä»ä¸Šå¾€ä¸‹ï¼Œæ¥çœ‹çœ‹è¿™é‡Œçš„ 14 å’Œ 20 éƒ½æ˜¯ä»€ä¹ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_6.png&#34;
	width=&#34;1468&#34;
	height=&#34;526&#34;
	srcset=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_6_hu_df1dfcff67c2b02e.png 480w, https://heaciy.com/p/analyzing-libpcap-pcap-file/image_6_hu_ee11b00d67cc8e12.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å›¾ 3.3.3 ç½‘ç»œæ¨¡å‹å’Œåè®®&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;279&#34;
		data-flex-basis=&#34;669px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 3.3.3 ç½‘ç»œæ¨¡å‹å’Œåè®®&lt;/p&gt;
&lt;p&gt;ç”±ä¸Šè¿°å›¾ 3.3.2 Wireshark çš„æˆªå›¾æˆ‘ä»¬å¯çŸ¥ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…æ•è·çš„å†…å®¹å³ä¸º HTTP åè®®åœ¨å»ºç«‹ TCP è¿æ¥å‰ï¼ˆHTTP 1.* åè®®æ˜¯åŸºäº TCP åè®®çš„ï¼‰ç”±å®¢æˆ·ç«¯å‘èµ·çš„ç¬¬ä¸€ä¸ª ACK è¯·æ±‚ã€‚äºæ˜¯æˆ‘ä»¬ä» TCP åè®®æ‰€åœ¨çš„ä¼ è¾“å±‚å¾€ä¸‹åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_7.png&#34;
	width=&#34;1440&#34;
	height=&#34;580&#34;
	srcset=&#34;https://heaciy.com/p/analyzing-libpcap-pcap-file/image_7_hu_837d836a9f271d2f.png 480w, https://heaciy.com/p/analyzing-libpcap-pcap-file/image_7_hu_2bc36e96d13bf2b4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å›¾ 3.3.4 ç½‘ç»œæ¨¡å‹ æ•°æ®å‘é€æµç¨‹ä¸­æ•°æ®çš„ä¼ é€’è¿‡ç¨‹&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;248&#34;
		data-flex-basis=&#34;595px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›¾ 3.3.4 ç½‘ç»œæ¨¡å‹ æ•°æ®å‘é€æµç¨‹ä¸­æ•°æ®çš„ä¼ é€’è¿‡ç¨‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼ è¾“å±‚&lt;/strong&gt;ï¼šç¬¬ä¸€ä¸ªæ•°æ®åŒ…æ•è·çš„æ˜¯ TCP å»ºç«‹è¿æ¥å‰çš„ç¬¬ä¸€ä¸ªç”±å®¢æˆ·ç«¯å‘èµ·çš„ ACK è¯·æ±‚ï¼Œç”±äºæ­¤æ¬¡åªä½¿ç”¨åˆ°äº† TCP åè®®çš„å¤´éƒ¨ï¼Œæ•…ä¸ºä¼ è¾“å±‚çš„æŠ¥æ–‡æ®µï¼ˆsegmentï¼‰çš„é•¿åº¦å³ä¸º TCP åè®®å¤´éƒ¨çš„é•¿åº¦ï¼Œå³ 20 å­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œå±‚&lt;/strong&gt;ï¼šä¸Šè¿°ä¼ è¾“å±‚çš„æŠ¥æ–‡å‘ä¸‹äº¤ç”±ç½‘ç»œå±‚å¤„ç†ï¼Œç½‘ç»œå±‚ä¼šä¸ºå…¶å¢åŠ ä¸€ä¸ªç½‘ç»œå±‚å¤´éƒ¨ï¼ˆ20å­—èŠ‚ï¼‰ï¼Œç„¶åç»§ç»­å‘ä¸‹å±‚æ•°æ®é“¾è·¯å±‚ä¼ é€’ã€‚æ•…è€Œç½‘ç»œå±‚å°è£…å¥½åæ•°æ®åŒ…ï¼ˆPacketï¼Œè¿™é‡Œçš„PacketæŒ‡ç½‘ç»œå±‚æ•°æ®åŒ…ï¼Œä¸ Pcap æ–‡ä»¶ä¸­çš„æ•°æ®åŒ…ä¸ºä¸åŒæ¦‚å¿µï¼‰å¤§å°ä¸ºï¼š
&lt;code&gt;ç½‘ç»œå±‚æ•°æ®åŒ…å¤´é•¿åº¦ï¼ˆ20 å­—èŠ‚ï¼‰+ ç½‘ç»œå±‚æ•°æ®åŒ…çš„æ•°æ®ä½“é•¿åº¦ï¼ˆ20 å­—èŠ‚ï¼‰= 40 å­—èŠ‚&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®é“¾è·¯å±‚&lt;/strong&gt;ï¼šä¸Šè¿°ç½‘ç»œå±‚çš„æ•°æ®åŒ…ï¼ˆ40 å­—èŠ‚ï¼‰å‘ä¸‹äº¤ç”±æ•°æ®é“¾è·¯å±‚å¤„ç†ï¼Œæ•°æ®é“¾è·¯å±‚ä¼šä¸ºå…¶åŠ ä¸Šä¸€ä¸ªæ•°æ®é“¾è·¯å±‚å¤´éƒ¨ï¼ˆ14 å­—èŠ‚ï¼‰å’Œæ•°æ®é“¾è·¯å±‚å°¾éƒ¨ï¼ˆFCS å³å¸§æ ¡éªŒåºåˆ—ï¼Œ4å­—èŠ‚ï¼‰è¿›è€Œç»„æˆä¸€ä¸ªæ•°æ®é“¾è·¯å±‚çš„å¸§ã€‚æ•…è€Œæ­¤å¸§çš„å¤§å°ä¸ºï¼š
&lt;code&gt;å¸§å¤´ï¼ˆ14å­—èŠ‚ï¼‰+ å¸§è´Ÿè½½ï¼ˆ40å­—èŠ‚ï¼‰+ å¸§å°¾ï¼ˆ4å­—èŠ‚ï¼‰= 54 + 4 = 58å­—èŠ‚&lt;/code&gt;
æ­¤æ—¶æœ‰æœ‹å‹å¯èƒ½å·²ç»å‘ç°å¼‚å¸¸äº†ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸Šè¿° Pcap æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„æ•°æ®ä½“åªæœ‰ 54 å­—èŠ‚ï¼Œç›¸æ¯”æˆ‘ä»¬çš„è®¡ç®—å€¼å°‘äº† 4 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼ŒåŸå› å¾ˆç®€å•å› ä¸ºæ•°æ®é“¾å±‚çš„å¸§å°¾æ˜¯ç”±ç½‘å¡è´Ÿè´£å¤„ç†çš„ï¼Œç½‘å¡è´Ÿè´£å¸§å°¾çš„è®¡ç®—å’Œæ ¡éªŒï¼Œåœ¨å‘é€æ•°æ®æ—¶ç½‘å¡è®¡ç®—å¹¶æ·»åŠ å¸§å°¾åå°†æ•°æ®å‘å‡ºï¼Œåœ¨æ”¶åˆ°æ•°æ®æ—¶ç½‘å¡æ ¡éªŒå¹¶å»é™¤å¸§å°¾åå†å‘ä¸Šå±‚ä¼ é€’ï¼Œæ•…è€Œæˆ‘ä»¬æ‹¿åˆ°çš„æ•°æ®é“¾è·¯å±‚å¸§å…¶å®æ˜¯é€šè¿‡äº†å¸§å°¾æ ¡éªŒå¹¶å»é™¤äº†å¸§å°¾ä¹‹åçš„æ•°æ®ï¼Œæ‰€ä»¥å°±æ˜¯ &lt;code&gt;58 - 4 = 54&lt;/code&gt; å­—èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”±ä¸Šè¿°ä¿¡æ¯å¯çŸ¥ï¼ŒPcap æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„ 54 å­—èŠ‚æ•°æ®ä½“ä¸­ï¼Œå‰ 14 å­—èŠ‚ä¸ºæ•°æ®é“¾è·¯å±‚å¤´éƒ¨ï¼Œå¾€åä¸­é—´çš„ 20 å­—èŠ‚ä¸ºç½‘ç»œå±‚å¤´éƒ¨ï¼Œæœ€å 20 å­—èŠ‚å³ä¸ºä¼ è¾“å±‚å¤´éƒ¨ï¼ˆä¸ºä»€ä¹ˆåªæœ‰å¤´éƒ¨æ²¡æœ‰æ•°æ®ä½“ï¼Ÿå› ä¸ºTCPå»ºç«‹è¿æ¥å‰çš„ç¬¬ä¸€æ¬¡ ACK è¯·æ±‚ç”¨ä¸ä¸Šæ•°æ®ä½“ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬å°±ä¸å†æŒ‰ç…§å­—èŠ‚å»åˆ†æé“¾è·¯å±‚ã€ç½‘ç»œå±‚æˆ–æ˜¯ä¼ è¾“å±‚çš„å¤´éƒ¨ä¿¡æ¯äº†ï¼Œå› ä¸º Wireshark å·²ç»å¯ä»¥å¾ˆå¥½çš„å¸®æˆ‘ä»¬åˆ†æã€‚æœ‰ä¸€ä¸ªç»†èŠ‚æ˜¯ï¼Œè™½ç„¶è¯¥ Pcap æ–‡ä»¶çš„å­—èŠ‚åºæ˜¯å°ç«¯åºï¼Œä½†æ˜¯åœ¨è®¡ç®—é“¾è·¯å±‚ã€ç½‘ç»œå±‚ç­‰å±‚çš„å¤´éƒ¨ä¿¡æ¯æ—¶ï¼Œå¯¹äºå¤šå­—èŠ‚å­—æ®µä¸éœ€è¦å€’æ’å­—èŠ‚ï¼Œå› ä¸ºç½‘ç»œä¼ è¾“ä½¿ç”¨çš„æ˜¯å¤§ç«¯åºï¼Œåˆå› ä¸º Pcap æ–‡ä»¶ä¸­æ¯ä¸€ä¸ªæ•°æ®åŒ…çš„æ•°æ®ä½“éƒ½æ˜¯ä¸€ä¸ªâ€æ•°æ®é“¾è·¯å±‚å¸§â€ï¼Œå¹¶æœªåšå…¶ä»–è½¬æ¢ï¼Œæ•…è€Œæ•°æ®ä½“ä¸­çš„æ•°æ®ä¹Ÿæ˜¯å¤§ç«¯åºï¼Œåœ¨è®¡ç®—è·¨å­—èŠ‚æ•°æ®æ—¶ä¸éœ€è¦é€†è½¬å­—èŠ‚é¡ºåºã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“
&lt;/h2&gt;&lt;p&gt;è‡³æ­¤æˆ‘ä»¬å®Œæˆäº† Libpcap æ ¼å¼çš„ Pcap æ–‡ä»¶æ•°æ®æ„é€ åˆ†æã€‚å¹¶ä»¥ä¸€ä¸ªå®é™…çš„ Pcap æ–‡ä»¶ä½œä¸ºä¾‹å­è¿›è¡Œäº†å¯¹ç…§å­¦ä¹ ã€‚è§£ç­”äº†å‰è¨€ä¸­æå‡ºçš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Pcap æ–‡ä»¶çš„æ•°æ®æ„é€ ï¼Ÿ&lt;/p&gt;
&lt;p&gt;Pcap æ–‡ä»¶ç”±ä¸€ä¸ª 24 å­—èŠ‚çš„å…¨å±€å¤´éƒ¨ï¼ˆGlobal Headerï¼‰ï¼Œå’Œå¤šä¸ªæ•°æ®åŒ…ï¼ˆPacketï¼‰ç»„æˆï¼›æ¯ä¸€ä¸ªæ•°æ®åŒ…åˆç”± 16 å­—èŠ‚çš„å¤´éƒ¨ï¼ˆPacket Headerï¼‰å’Œæ•°æ®ä½“ï¼ˆPacket Dataï¼‰ç»„æˆï¼Œæ•°æ®ä½“çš„é•¿åº¦ç”±å¤´éƒ¨å­—æ®µ Captured Packet Length è®°å½•ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pcap æ–‡ä»¶çš„æ•°æ®åŒ…ä¸­çš„æ•°æ®ä½“ï¼ˆPacket Dataï¼‰ä¿å­˜çš„æ˜¯ä»€ä¹ˆå†…å®¹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;Pcap æ–‡ä»¶ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®åŒ…å¯¹åº” WireShark ä¸­çš„ä¸€æ¡è®°å½•ï¼›æ¯ä¸€ä¸ªæ•°æ®åŒ…ä¸­çš„æ•°æ®ä½“å¯¹åº”ä¸€ä¸ªæ•è·åˆ°çš„â€œæ•°æ®é“¾è·¯å±‚çš„å¸§â€ï¼ˆæ—  FCS å¸§å°¾ï¼‰ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ¬æ–‡å¹¶æœªæåŠ Pcap åŒ…çš„æ•è·å’Œå›æ”¾æ–¹æ³•ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œæ£€ç´¢ï¼Œå…·ä½“å®ç°æ–¹æ³•åŒ…æ‹¬ä½†ä¸é™äºï¼šåŸå§‹å¥—æ¥å­—ã€DPDKã€XDP&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒé“¾æ¥&#34;&gt;å‚è€ƒé“¾æ¥
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.wireshark.org/Development/LibpcapFileFormat&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Libpcap File Format&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.wireshark.org/FileFormatReference&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Capture File Format Reference&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.tcpdump.org/linktypes.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Pcap link types&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        
    </channel>
</rss>
